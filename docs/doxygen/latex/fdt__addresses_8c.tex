\hypertarget{fdt__addresses_8c}{\section{/users/enseig/franck/ko6/src/soft/external/libfdt/fdt\-\_\-addresses.c File Reference}
\label{fdt__addresses_8c}\index{/users/enseig/franck/ko6/src/soft/external/libfdt/fdt\-\_\-addresses.\-c@{/users/enseig/franck/ko6/src/soft/external/libfdt/fdt\-\_\-addresses.\-c}}
}
{\ttfamily \#include \char`\"{}libfdt\-\_\-env.\-h\char`\"{}}\\*
{\ttfamily \#include $<$external/libfdt/fdt.\-h$>$}\\*
{\ttfamily \#include $<$external/libfdt/libfdt.\-h$>$}\\*
{\ttfamily \#include \char`\"{}libfdt\-\_\-internal.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{fdt__addresses_8c_ab53e36aeec213b1a0acee1363e4e8795}{fdt\-\_\-cells} (const void $\ast$fdt, int nodeoffset, const char $\ast$name)
\item 
int \hyperlink{fdt__addresses_8c_abc8a070eb5c099eb1718f45134a0915e}{fdt\-\_\-address\-\_\-cells} (const void $\ast$fdt, int nodeoffset)
\item 
int \hyperlink{fdt__addresses_8c_a314966b6182211c6d38cc90748c3234b}{fdt\-\_\-size\-\_\-cells} (const void $\ast$fdt, int nodeoffset)
\item 
int \hyperlink{fdt__addresses_8c_a6039a3956086acc2caa68458393f3825}{fdt\-\_\-appendprop\-\_\-addrrange} (void $\ast$fdt, int parent, int nodeoffset, const char $\ast$name, \hyperlink{libfdt__env_8h_aaa5d1cd013383c889537491c3cfd9aad}{uint64\-\_\-t} addr, \hyperlink{libfdt__env_8h_aaa5d1cd013383c889537491c3cfd9aad}{uint64\-\_\-t} size)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{fdt__addresses_8c_abc8a070eb5c099eb1718f45134a0915e}{\index{fdt\-\_\-addresses.\-c@{fdt\-\_\-addresses.\-c}!fdt\-\_\-address\-\_\-cells@{fdt\-\_\-address\-\_\-cells}}
\index{fdt\-\_\-address\-\_\-cells@{fdt\-\_\-address\-\_\-cells}!fdt_addresses.c@{fdt\-\_\-addresses.\-c}}
\subsubsection[{fdt\-\_\-address\-\_\-cells}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-address\-\_\-cells (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset}
\end{DoxyParamCaption}
)}}\label{fdt__addresses_8c_abc8a070eb5c099eb1718f45134a0915e}
fdt\-\_\-address\-\_\-cells -\/ retrieve address size for a bus represented in the tree \-: pointer to the device tree blob \-: offset of the node to find the address size for

When the node has a valid \#address-\/cells property, returns its value.

returns\-: 0 $<$= n $<$ F\-D\-T\-\_\-\-M\-A\-X\-\_\-\-N\-C\-E\-L\-L\-S, on success 2, if the node has no \#address-\/cells property -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-N\-C\-E\-L\-L\-S, if the node has a badly formatted or invalid \#address-\/cells property -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings 

References fdt\-\_\-cells(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-N\-C\-E\-L\-L\-S, and F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D.



Referenced by fdt\-\_\-appendprop\-\_\-addrrange().


\begin{DoxyCode}
35 \{
36     \textcolor{keywordtype}{int} val;
37 
38     val = \hyperlink{fdt__addresses_8c_ab53e36aeec213b1a0acee1363e4e8795}{fdt\_cells}(fdt, nodeoffset, \textcolor{stringliteral}{"#address-cells"});
39     \textcolor{keywordflow}{if} (val == 0)
40         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_ac99b64a390af02e95d9236e5c1d03780}{FDT\_ERR\_BADNCELLS};
41     \textcolor{keywordflow}{if} (val == -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND})
42         \textcolor{keywordflow}{return} 2;
43     \textcolor{keywordflow}{return} val;
44 \}
\end{DoxyCode}
\hypertarget{fdt__addresses_8c_a6039a3956086acc2caa68458393f3825}{\index{fdt\-\_\-addresses.\-c@{fdt\-\_\-addresses.\-c}!fdt\-\_\-appendprop\-\_\-addrrange@{fdt\-\_\-appendprop\-\_\-addrrange}}
\index{fdt\-\_\-appendprop\-\_\-addrrange@{fdt\-\_\-appendprop\-\_\-addrrange}!fdt_addresses.c@{fdt\-\_\-addresses.\-c}}
\subsubsection[{fdt\-\_\-appendprop\-\_\-addrrange}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-appendprop\-\_\-addrrange (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{fdt, }
\item[{int}]{parent, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{name, }
\item[{{\bf uint64\-\_\-t}}]{addr, }
\item[{{\bf uint64\-\_\-t}}]{size}
\end{DoxyParamCaption}
)}}\label{fdt__addresses_8c_a6039a3956086acc2caa68458393f3825}


References fdt32\-\_\-st(), fdt64\-\_\-st(), fdt\-\_\-address\-\_\-cells(), fdt\-\_\-appendprop(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-N\-C\-E\-L\-L\-S, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-A\-L\-U\-E, fdt\-\_\-size\-\_\-cells(), and U\-I\-N\-T32\-\_\-\-M\-A\-X.


\begin{DoxyCode}
59 \{
60     \textcolor{keywordtype}{int} addr\_cells, size\_cells, ret;
61     \hyperlink{libfdt__env_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} \hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data}[\textcolor{keyword}{sizeof}(\hyperlink{libfdt__env_8h_ace50a73711239df43c98cc1d5fedd1f8}{fdt64\_t}) * 2], *prop;
62 
63     ret = \hyperlink{fdt__addresses_8c_abc8a070eb5c099eb1718f45134a0915e}{fdt\_address\_cells}(fdt, parent);
64     \textcolor{keywordflow}{if} (ret < 0)
65         \textcolor{keywordflow}{return} ret;
66     addr\_cells = ret;
67 
68     ret = \hyperlink{fdt__addresses_8c_a314966b6182211c6d38cc90748c3234b}{fdt\_size\_cells}(fdt, parent);
69     \textcolor{keywordflow}{if} (ret < 0)
70         \textcolor{keywordflow}{return} ret;
71     size\_cells = ret;
72 
73     \textcolor{comment}{/* check validity of address */}
74     prop = \hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data};
75     \textcolor{keywordflow}{if} (addr\_cells == 1) \{
76         \textcolor{keywordflow}{if} ((addr > \hyperlink{cstd_8h_ab5eb23180f7cc12b7d6c04a8ec067fdd}{UINT32\_MAX}) || (((\hyperlink{libfdt__env_8h_aaa5d1cd013383c889537491c3cfd9aad}{uint64\_t}) \hyperlink{cstd_8h_ab5eb23180f7cc12b7d6c04a8ec067fdd}{UINT32\_MAX} + 1 - addr) < size))
77             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a69e818556330b83a02de930b95216aa9}{FDT\_ERR\_BADVALUE};
78 
79         \hyperlink{libfdt_8h_ab8e8a5e7bfa68ba11228a13dfd5baa9a}{fdt32\_st}(prop, (\hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t})addr);
80     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (addr\_cells == 2) \{
81         \hyperlink{libfdt_8h_a44619630fdd13843118f56d8bda08256}{fdt64\_st}(prop, addr);
82     \} \textcolor{keywordflow}{else} \{
83         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_ac99b64a390af02e95d9236e5c1d03780}{FDT\_ERR\_BADNCELLS};
84     \}
85 
86     \textcolor{comment}{/* check validity of size */}
87     prop += addr\_cells * \textcolor{keyword}{sizeof}(\hyperlink{libfdt__env_8h_a76887ac8786252752fb3f9a39b21f3af}{fdt32\_t});
88     \textcolor{keywordflow}{if} (size\_cells == 1) \{
89         \textcolor{keywordflow}{if} (size > \hyperlink{cstd_8h_ab5eb23180f7cc12b7d6c04a8ec067fdd}{UINT32\_MAX})
90             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a69e818556330b83a02de930b95216aa9}{FDT\_ERR\_BADVALUE};
91 
92         \hyperlink{libfdt_8h_ab8e8a5e7bfa68ba11228a13dfd5baa9a}{fdt32\_st}(prop, (\hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t})size);
93     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (size\_cells == 2) \{
94         \hyperlink{libfdt_8h_a44619630fdd13843118f56d8bda08256}{fdt64\_st}(prop, size);
95     \} \textcolor{keywordflow}{else} \{
96         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_ac99b64a390af02e95d9236e5c1d03780}{FDT\_ERR\_BADNCELLS};
97     \}
98 
99     \textcolor{keywordflow}{return} \hyperlink{fdt__rw_8c_a26f2518e2c64f013069c613bee7a83a3}{fdt\_appendprop}(fdt, nodeoffset, name, \hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data},
100                   (addr\_cells + size\_cells) * \textcolor{keyword}{sizeof}(\hyperlink{libfdt__env_8h_a76887ac8786252752fb3f9a39b21f3af}{fdt32\_t}));
101 \}
\end{DoxyCode}
\hypertarget{fdt__addresses_8c_ab53e36aeec213b1a0acee1363e4e8795}{\index{fdt\-\_\-addresses.\-c@{fdt\-\_\-addresses.\-c}!fdt\-\_\-cells@{fdt\-\_\-cells}}
\index{fdt\-\_\-cells@{fdt\-\_\-cells}!fdt_addresses.c@{fdt\-\_\-addresses.\-c}}
\subsubsection[{fdt\-\_\-cells}]{\setlength{\rightskip}{0pt plus 5cm}static int fdt\-\_\-cells (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__addresses_8c_ab53e36aeec213b1a0acee1363e4e8795}


References fdt32\-\_\-to\-\_\-cpu(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-N\-C\-E\-L\-L\-S, fdt\-\_\-getprop(), and F\-D\-T\-\_\-\-M\-A\-X\-\_\-\-N\-C\-E\-L\-L\-S.



Referenced by fdt\-\_\-address\-\_\-cells(), and fdt\-\_\-size\-\_\-cells().


\begin{DoxyCode}
15 \{
16     \textcolor{keyword}{const} \hyperlink{libfdt__env_8h_a76887ac8786252752fb3f9a39b21f3af}{fdt32\_t} *c;
17     \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} val;
18     \textcolor{keywordtype}{int} \hyperlink{structfdt__property_a48e6236319453578c3ca7c106b382a2f}{len};
19 
20     c = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, name, &len);
21     \textcolor{keywordflow}{if} (!c)
22         \textcolor{keywordflow}{return} \hyperlink{structfdt__property_a48e6236319453578c3ca7c106b382a2f}{len};
23 
24     \textcolor{keywordflow}{if} (len != \textcolor{keyword}{sizeof}(*c))
25         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_ac99b64a390af02e95d9236e5c1d03780}{FDT\_ERR\_BADNCELLS};
26 
27     val = \hyperlink{libfdt__env_8h_a6485ea7225a1927cc5ab1a34dabe298f}{fdt32\_to\_cpu}(*c);
28     \textcolor{keywordflow}{if} (val > \hyperlink{libfdt_8h_a69cac5a5447cfd945064ef3da50e8b6d}{FDT\_MAX\_NCELLS})
29         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_ac99b64a390af02e95d9236e5c1d03780}{FDT\_ERR\_BADNCELLS};
30 
31     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})val;
32 \}
\end{DoxyCode}
\hypertarget{fdt__addresses_8c_a314966b6182211c6d38cc90748c3234b}{\index{fdt\-\_\-addresses.\-c@{fdt\-\_\-addresses.\-c}!fdt\-\_\-size\-\_\-cells@{fdt\-\_\-size\-\_\-cells}}
\index{fdt\-\_\-size\-\_\-cells@{fdt\-\_\-size\-\_\-cells}!fdt_addresses.c@{fdt\-\_\-addresses.\-c}}
\subsubsection[{fdt\-\_\-size\-\_\-cells}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-size\-\_\-cells (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset}
\end{DoxyParamCaption}
)}}\label{fdt__addresses_8c_a314966b6182211c6d38cc90748c3234b}
fdt\-\_\-size\-\_\-cells -\/ retrieve address range size for a bus represented in the tree \-: pointer to the device tree blob \-: offset of the node to find the address range size for

When the node has a valid \#size-\/cells property, returns its value.

returns\-: 0 $<$= n $<$ F\-D\-T\-\_\-\-M\-A\-X\-\_\-\-N\-C\-E\-L\-L\-S, on success 1, if the node has no \#size-\/cells property -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-N\-C\-E\-L\-L\-S, if the node has a badly formatted or invalid \#size-\/cells property -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings 

References fdt\-\_\-cells(), and F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D.



Referenced by fdt\-\_\-appendprop\-\_\-addrrange().


\begin{DoxyCode}
47 \{
48     \textcolor{keywordtype}{int} val;
49 
50     val = \hyperlink{fdt__addresses_8c_ab53e36aeec213b1a0acee1363e4e8795}{fdt\_cells}(fdt, nodeoffset, \textcolor{stringliteral}{"#size-cells"});
51     \textcolor{keywordflow}{if} (val == -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND})
52         \textcolor{keywordflow}{return} 1;
53     \textcolor{keywordflow}{return} val;
54 \}
\end{DoxyCode}
