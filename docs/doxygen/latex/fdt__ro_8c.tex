\hypertarget{fdt__ro_8c}{\section{/users/enseig/franck/ko6/src/soft/external/libfdt/fdt\-\_\-ro.c File Reference}
\label{fdt__ro_8c}\index{/users/enseig/franck/ko6/src/soft/external/libfdt/fdt\-\_\-ro.\-c@{/users/enseig/franck/ko6/src/soft/external/libfdt/fdt\-\_\-ro.\-c}}
}
{\ttfamily \#include \char`\"{}libfdt\-\_\-env.\-h\char`\"{}}\\*
{\ttfamily \#include $<$external/libfdt/fdt.\-h$>$}\\*
{\ttfamily \#include $<$external/libfdt/libfdt.\-h$>$}\\*
{\ttfamily \#include \char`\"{}libfdt\-\_\-internal.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{fdt__ro_8c_a2d417f67da75b1ebf2871428d952cf8f}{fdt\-\_\-nodename\-\_\-eq\-\_\-} (const void $\ast$fdt, int offset, const char $\ast$s, int len)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}{fdt\-\_\-get\-\_\-string} (const void $\ast$fdt, int stroffset, int $\ast$lenp)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_a5ccdba67e9d56872ef16dcbd405da94a}{fdt\-\_\-string} (const void $\ast$fdt, int stroffset)
\item 
static int \hyperlink{fdt__ro_8c_a4bbeefd40ad440c5e41c60cc431fae7a}{fdt\-\_\-string\-\_\-eq\-\_\-} (const void $\ast$fdt, int stroffset, const char $\ast$s, int len)
\item 
int \hyperlink{fdt__ro_8c_a57fbf6be8c4911e8448942b9fed97301}{fdt\-\_\-find\-\_\-max\-\_\-phandle} (const void $\ast$fdt, \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} $\ast$phandle)
\item 
int \hyperlink{fdt__ro_8c_a7ad648a7cf17f33659fb6cbb9545ce38}{fdt\-\_\-generate\-\_\-phandle} (const void $\ast$fdt, \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} $\ast$phandle)
\item 
static struct \hyperlink{structfdt__reserve__entry}{fdt\-\_\-reserve\-\_\-entry} $\ast$ \hyperlink{fdt__ro_8c_aa26d083555e092c1fc4f07a452502eb4}{fdt\-\_\-mem\-\_\-rsv} (const void $\ast$fdt, int n)
\item 
int \hyperlink{fdt__ro_8c_a4c50a267dcbd5c24256040e5c60362e6}{fdt\-\_\-get\-\_\-mem\-\_\-rsv} (const void $\ast$fdt, int n, \hyperlink{libfdt__env_8h_aaa5d1cd013383c889537491c3cfd9aad}{uint64\-\_\-t} $\ast$address, \hyperlink{libfdt__env_8h_aaa5d1cd013383c889537491c3cfd9aad}{uint64\-\_\-t} $\ast$size)
\item 
int \hyperlink{fdt__ro_8c_a79fa5b76564c75c9fb00fe8ca3ba3eee}{fdt\-\_\-num\-\_\-mem\-\_\-rsv} (const void $\ast$fdt)
\item 
static int \hyperlink{fdt__ro_8c_a0a233378abbb816de0249098cb2fc450}{nextprop\-\_\-} (const void $\ast$fdt, int offset)
\item 
int \hyperlink{fdt__ro_8c_a515ddadab660b50e9d31c05c74f7d351}{fdt\-\_\-subnode\-\_\-offset\-\_\-namelen} (const void $\ast$fdt, int offset, const char $\ast$name, int namelen)
\item 
int \hyperlink{fdt__ro_8c_a22dd90f8bea25063fe0debae7683eb02}{fdt\-\_\-subnode\-\_\-offset} (const void $\ast$fdt, int parentoffset, const char $\ast$name)
\item 
int \hyperlink{fdt__ro_8c_aa8b4d143366fc7d443f47c1c92a8f8cc}{fdt\-\_\-path\-\_\-offset\-\_\-namelen} (const void $\ast$fdt, const char $\ast$path, int namelen)
\item 
int \hyperlink{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}{fdt\-\_\-path\-\_\-offset} (const void $\ast$fdt, const char $\ast$path)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_a22a72941a288c00c88c36164fdc793c0}{fdt\-\_\-get\-\_\-name} (const void $\ast$fdt, int nodeoffset, int $\ast$len)
\item 
int \hyperlink{fdt__ro_8c_aba2e2271df9d7cbcbb6ac633bd169bcf}{fdt\-\_\-first\-\_\-property\-\_\-offset} (const void $\ast$fdt, int nodeoffset)
\item 
int \hyperlink{fdt__ro_8c_ad17c7077eebb6668f09aadda1f6c8fb2}{fdt\-\_\-next\-\_\-property\-\_\-offset} (const void $\ast$fdt, int offset)
\item 
static struct \hyperlink{structfdt__property}{fdt\-\_\-property} $\ast$ \hyperlink{fdt__ro_8c_a5968ba67990c99975ff5746c4f80c85a}{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-} (const void $\ast$fdt, int offset, int $\ast$lenp)
\item 
struct \hyperlink{structfdt__property}{fdt\-\_\-property} $\ast$ \hyperlink{fdt__ro_8c_a7de37480221a0d3381830233027d32bd}{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset} (const void $\ast$fdt, int offset, int $\ast$lenp)
\item 
static struct \hyperlink{structfdt__property}{fdt\-\_\-property} $\ast$ \hyperlink{fdt__ro_8c_a3fbd5b94defd29f9e25d8433a03529e9}{fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-} (const void $\ast$fdt, int offset, const char $\ast$name, int namelen, int $\ast$lenp, int $\ast$poffset)
\item 
struct \hyperlink{structfdt__property}{fdt\-\_\-property} $\ast$ \hyperlink{fdt__ro_8c_ac9739a424852c1400e3c09e5a1bf4364}{fdt\-\_\-get\-\_\-property\-\_\-namelen} (const void $\ast$fdt, int offset, const char $\ast$name, int namelen, int $\ast$lenp)
\item 
struct \hyperlink{structfdt__property}{fdt\-\_\-property} $\ast$ \hyperlink{fdt__ro_8c_a7f394390ede4870838765689941c6e3c}{fdt\-\_\-get\-\_\-property} (const void $\ast$fdt, int nodeoffset, const char $\ast$name, int $\ast$lenp)
\item 
const void $\ast$ \hyperlink{fdt__ro_8c_af06aa67642c5e97ec636619a4ac3f19a}{fdt\-\_\-getprop\-\_\-namelen} (const void $\ast$fdt, int nodeoffset, const char $\ast$name, int namelen, int $\ast$lenp)
\item 
const void $\ast$ \hyperlink{fdt__ro_8c_a631207472dcddda9470f5791260da0fd}{fdt\-\_\-getprop\-\_\-by\-\_\-offset} (const void $\ast$fdt, int offset, const char $\ast$$\ast$namep, int $\ast$lenp)
\item 
const void $\ast$ \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\-\_\-getprop} (const void $\ast$fdt, int nodeoffset, const char $\ast$name, int $\ast$lenp)
\item 
\hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} \hyperlink{fdt__ro_8c_a0689bb9f27bdaaa355855425b4eb7149}{fdt\-\_\-get\-\_\-phandle} (const void $\ast$fdt, int nodeoffset)
\item 
static const void $\ast$ \hyperlink{fdt__ro_8c_a4f970773c1f5023ddb012f1f5d799c5e}{fdt\-\_\-path\-\_\-getprop\-\_\-namelen} (const void $\ast$fdt, const char $\ast$path, const char $\ast$propname, int propnamelen, int $\ast$lenp)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_a1446c9a325c1348d88007632675f2641}{fdt\-\_\-get\-\_\-alias\-\_\-namelen} (const void $\ast$fdt, const char $\ast$name, int namelen)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_af65ebffdb681288cefa41db5ad41d1fe}{fdt\-\_\-get\-\_\-alias} (const void $\ast$fdt, const char $\ast$name)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_ab6e268a7c7fef650ee0c08f7010ae914}{fdt\-\_\-get\-\_\-symbol\-\_\-namelen} (const void $\ast$fdt, const char $\ast$name, int namelen)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_a9d7a5c166e18e81722839c0b5a0541ee}{fdt\-\_\-get\-\_\-symbol} (const void $\ast$fdt, const char $\ast$name)
\item 
int \hyperlink{fdt__ro_8c_a7b25d4bc3dd83403a39ef84b8a362bd5}{fdt\-\_\-get\-\_\-path} (const void $\ast$fdt, int nodeoffset, char $\ast$buf, int buflen)
\item 
int \hyperlink{fdt__ro_8c_a6c960d975c6644172ccc71fc2c48dbb4}{fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset} (const void $\ast$fdt, int nodeoffset, int supernodedepth, int $\ast$nodedepth)
\item 
int \hyperlink{fdt__ro_8c_a2c0d12a5988128f0b674d4ec24b709d8}{fdt\-\_\-node\-\_\-depth} (const void $\ast$fdt, int nodeoffset)
\item 
int \hyperlink{fdt__ro_8c_a2b518dbd88cb783a9bffa1680ab297f9}{fdt\-\_\-parent\-\_\-offset} (const void $\ast$fdt, int nodeoffset)
\item 
int \hyperlink{fdt__ro_8c_a99d317b082102ce9a3eea47e86ab5757}{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value} (const void $\ast$fdt, int startoffset, const char $\ast$propname, const void $\ast$propval, int proplen)
\item 
int \hyperlink{fdt__ro_8c_a4ff6571f3fe2fa89cfd6dc15f52eaf1e}{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle} (const void $\ast$fdt, \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} phandle)
\item 
int \hyperlink{fdt__ro_8c_a2492648af0491398295fac892cb8b758}{fdt\-\_\-stringlist\-\_\-contains} (const char $\ast$strlist, int listlen, const char $\ast$str)
\item 
int \hyperlink{fdt__ro_8c_a9d33c2ffed049f4f1c60ffef7b66fba4}{fdt\-\_\-stringlist\-\_\-count} (const void $\ast$fdt, int nodeoffset, const char $\ast$property)
\item 
int \hyperlink{fdt__ro_8c_a13feaf7df3d4cc7d7927d78af31dba3e}{fdt\-\_\-stringlist\-\_\-search} (const void $\ast$fdt, int nodeoffset, const char $\ast$property, const char $\ast$string)
\item 
const char $\ast$ \hyperlink{fdt__ro_8c_aff9e731b810e8052140509d0c4ee19b5}{fdt\-\_\-stringlist\-\_\-get} (const void $\ast$fdt, int nodeoffset, const char $\ast$property, int idx, int $\ast$lenp)
\item 
int \hyperlink{fdt__ro_8c_ade07583ac432de46013acb3a07eca7be}{fdt\-\_\-node\-\_\-check\-\_\-compatible} (const void $\ast$fdt, int nodeoffset, const char $\ast$compatible)
\item 
int \hyperlink{fdt__ro_8c_a7fee20e876e2af4dd32e987c6c8f104a}{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible} (const void $\ast$fdt, int startoffset, const char $\ast$compatible)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{fdt__ro_8c_a57fbf6be8c4911e8448942b9fed97301}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-find\-\_\-max\-\_\-phandle@{fdt\-\_\-find\-\_\-max\-\_\-phandle}}
\index{fdt\-\_\-find\-\_\-max\-\_\-phandle@{fdt\-\_\-find\-\_\-max\-\_\-phandle}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-find\-\_\-max\-\_\-phandle}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-find\-\_\-max\-\_\-phandle (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{{\bf uint32\-\_\-t} $\ast$}]{phandle}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a57fbf6be8c4911e8448942b9fed97301}
fdt\-\_\-find\-\_\-max\-\_\-phandle -\/ find and return the highest phandle in a tree \-: pointer to the device tree blob \-: return location for the highest phandle value found in the tree

\hyperlink{fdt__ro_8c_a57fbf6be8c4911e8448942b9fed97301}{fdt\-\_\-find\-\_\-max\-\_\-phandle()} finds the highest phandle value in the given device tree. The value returned in  is only valid if the function returns success.

returns\-: 0 on success or a negative error code on failure 

References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-get\-\_\-phandle(), fdt\-\_\-next\-\_\-node(), and N\-U\-L\-L.



Referenced by fdt\-\_\-generate\-\_\-phandle(), fdt\-\_\-get\-\_\-max\-\_\-phandle(), and fdt\-\_\-overlay\-\_\-apply().


\begin{DoxyCode}
115 \{
116     \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} max = 0;
117     \textcolor{keywordtype}{int} offset = -1;
118 
119     \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{
120         \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} value;
121 
122         offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
123         \textcolor{keywordflow}{if} (offset < 0) \{
124             \textcolor{keywordflow}{if} (offset == -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND})
125                 \textcolor{keywordflow}{break};
126 
127             \textcolor{keywordflow}{return} offset;
128         \}
129 
130         value = \hyperlink{fdt__ro_8c_a0689bb9f27bdaaa355855425b4eb7149}{fdt\_get\_phandle}(fdt, offset);
131 
132         \textcolor{keywordflow}{if} (value > max)
133             max = value;
134     \}
135 
136     \textcolor{keywordflow}{if} (phandle)
137         *phandle = max;
138 
139     \textcolor{keywordflow}{return} 0;
140 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_aba2e2271df9d7cbcbb6ac633bd169bcf}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-first\-\_\-property\-\_\-offset@{fdt\-\_\-first\-\_\-property\-\_\-offset}}
\index{fdt\-\_\-first\-\_\-property\-\_\-offset@{fdt\-\_\-first\-\_\-property\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-first\-\_\-property\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-first\-\_\-property\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_aba2e2271df9d7cbcbb6ac633bd169bcf}
fdt\-\_\-first\-\_\-property\-\_\-offset -\/ find the offset of a node's first property \-: pointer to the device tree blob \-: structure block offset of a node

\hyperlink{fdt__ro_8c_aba2e2271df9d7cbcbb6ac633bd169bcf}{fdt\-\_\-first\-\_\-property\-\_\-offset()} finds the first property of the node at the given structure block offset.

returns\-: structure block offset of the property ($>$=0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, if the requested node has no properties -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, if nodeoffset did not point to an F\-D\-T\-\_\-\-B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings. 

References fdt\-\_\-check\-\_\-node\-\_\-offset\-\_\-(), and nextprop\-\_\-().



Referenced by fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-().


\begin{DoxyCode}
339 \{
340     \textcolor{keywordtype}{int} offset;
341 
342     \textcolor{keywordflow}{if} ((offset = \hyperlink{fdt_8c_a8f4832389aff9d7c0663b6b70cdd42dd}{fdt\_check\_node\_offset\_}(fdt, nodeoffset)) < 0)
343         \textcolor{keywordflow}{return} offset;
344 
345     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a0a233378abbb816de0249098cb2fc450}{nextprop\_}(fdt, offset);
346 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a7ad648a7cf17f33659fb6cbb9545ce38}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-generate\-\_\-phandle@{fdt\-\_\-generate\-\_\-phandle}}
\index{fdt\-\_\-generate\-\_\-phandle@{fdt\-\_\-generate\-\_\-phandle}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-generate\-\_\-phandle}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-generate\-\_\-phandle (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{{\bf uint32\-\_\-t} $\ast$}]{phandle}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a7ad648a7cf17f33659fb6cbb9545ce38}
fdt\-\_\-generate\-\_\-phandle -\/ return a new, unused phandle for a device tree blob \-: pointer to the device tree blob \-: return location for the new phandle

Walks the device tree blob and looks for the highest phandle value. On success, the new, unused phandle value (one higher than the previously highest phandle value in the device tree blob) will be returned in the  parameter.

Return\-: 0 on success or a negative error-\/code on failure 

References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-P\-H\-A\-N\-D\-L\-E\-S, fdt\-\_\-find\-\_\-max\-\_\-phandle(), and F\-D\-T\-\_\-\-M\-A\-X\-\_\-\-P\-H\-A\-N\-D\-L\-E.


\begin{DoxyCode}
143 \{
144     \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} max;
145     \textcolor{keywordtype}{int} err;
146 
147     err = \hyperlink{fdt__ro_8c_a57fbf6be8c4911e8448942b9fed97301}{fdt\_find\_max\_phandle}(fdt, &max);
148     \textcolor{keywordflow}{if} (err < 0)
149         \textcolor{keywordflow}{return} err;
150 
151     \textcolor{keywordflow}{if} (max == \hyperlink{libfdt_8h_adf35cab72ef2f580fb1263c2c4d4f33a}{FDT\_MAX\_PHANDLE})
152         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a7dbda231b96112ab9cd6d2eca9b42bfb}{FDT\_ERR\_NOPHANDLES};
153 
154     \textcolor{keywordflow}{if} (phandle)
155         *phandle = max + 1;
156 
157     \textcolor{keywordflow}{return} 0;
158 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_af65ebffdb681288cefa41db5ad41d1fe}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-alias@{fdt\-\_\-get\-\_\-alias}}
\index{fdt\-\_\-get\-\_\-alias@{fdt\-\_\-get\-\_\-alias}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-alias}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-get\-\_\-alias (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_af65ebffdb681288cefa41db5ad41d1fe}


References fdt\-\_\-get\-\_\-alias\-\_\-namelen(), and strlen().


\begin{DoxyCode}
544 \{
545     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a1446c9a325c1348d88007632675f2641}{fdt\_get\_alias\_namelen}(fdt, name, \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(name));
546 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a1446c9a325c1348d88007632675f2641}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-alias\-\_\-namelen@{fdt\-\_\-get\-\_\-alias\-\_\-namelen}}
\index{fdt\-\_\-get\-\_\-alias\-\_\-namelen@{fdt\-\_\-get\-\_\-alias\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-alias\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-get\-\_\-alias\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{name, }
\item[{int}]{namelen}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a1446c9a325c1348d88007632675f2641}


References fdt\-\_\-path\-\_\-getprop\-\_\-namelen(), and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-alias(), and fdt\-\_\-path\-\_\-offset\-\_\-namelen().


\begin{DoxyCode}
539 \{
540     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a4f970773c1f5023ddb012f1f5d799c5e}{fdt\_path\_getprop\_namelen}(fdt, \textcolor{stringliteral}{"/aliases"}, name, namelen, 
      \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
541 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a4c50a267dcbd5c24256040e5c60362e6}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-mem\-\_\-rsv@{fdt\-\_\-get\-\_\-mem\-\_\-rsv}}
\index{fdt\-\_\-get\-\_\-mem\-\_\-rsv@{fdt\-\_\-get\-\_\-mem\-\_\-rsv}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-mem\-\_\-rsv}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-get\-\_\-mem\-\_\-rsv (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{n, }
\item[{{\bf uint64\-\_\-t} $\ast$}]{address, }
\item[{{\bf uint64\-\_\-t} $\ast$}]{size}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a4c50a267dcbd5c24256040e5c60362e6}
fdt\-\_\-get\-\_\-mem\-\_\-rsv -\/ retrieve one memory reserve map entry \-: pointer to the device tree blob \par
\-: index of reserve map entry \-: pointer to 64-\/bit variable to hold the start address \-: pointer to 64-\/bit variable to hold the size of the entry

On success,  and  will contain the address and size of the n-\/th reserve map entry from the device tree blob, in native-\/endian format.

returns\-: 0, on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, standard meanings 

References fdt\-\_\-reserve\-\_\-entry\-::address, can\-\_\-assume, fdt64\-\_\-ld\-\_\-(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, fdt\-\_\-mem\-\_\-rsv(), F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E, and fdt\-\_\-reserve\-\_\-entry\-::size.


\begin{DoxyCode}
176 \{
177     \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__reserve__entry}{fdt\_reserve\_entry} *re;
178 
179     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
180     re = \hyperlink{fdt__ro_8c_aa26d083555e092c1fc4f07a452502eb4}{fdt\_mem\_rsv}(fdt, n);
181     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(VALID\_INPUT) && !re)
182         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a5025b6b09a009bd2b516e6a831d7ce72}{FDT\_ERR\_BADOFFSET};
183 
184     *\hyperlink{structfdt__reserve__entry_a1453319ff97e2d7c2ec0762cee56e98e}{address} = \hyperlink{libfdt__internal_8h_af075236a40c956f7e24e7ba5235f35ce}{fdt64\_ld\_}(&re->\hyperlink{structfdt__reserve__entry_a1453319ff97e2d7c2ec0762cee56e98e}{address});
185     *\hyperlink{structfdt__reserve__entry_ace12399f157bc46877fbcddec98da67e}{size} = \hyperlink{libfdt__internal_8h_af075236a40c956f7e24e7ba5235f35ce}{fdt64\_ld\_}(&re->\hyperlink{structfdt__reserve__entry_ace12399f157bc46877fbcddec98da67e}{size});
186     \textcolor{keywordflow}{return} 0;
187 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a22a72941a288c00c88c36164fdc793c0}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-name@{fdt\-\_\-get\-\_\-name}}
\index{fdt\-\_\-get\-\_\-name@{fdt\-\_\-get\-\_\-name}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-name}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-get\-\_\-name (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a22a72941a288c00c88c36164fdc793c0}
fdt\-\_\-get\-\_\-name -\/ retrieve the name of a given node \-: pointer to the device tree blob \-: structure block offset of the starting node \-: pointer to an integer variable (will be overwritten) or N\-U\-L\-L

\hyperlink{fdt__ro_8c_a22a72941a288c00c88c36164fdc793c0}{fdt\-\_\-get\-\_\-name()} retrieves the name (including unit address) of the device tree node at structure block offset nodeoffset. If lenp is non-\/\-N\-U\-L\-L, the length of this name is also returned, in the integer pointed to by lenp.

returns\-: pointer to the node's name, on success If lenp is non-\/\-N\-U\-L\-L, $\ast$lenp contains the length of that name ($>$=0) N\-U\-L\-L, on error if lenp is non-\/\-N\-U\-L\-L $\ast$lenp contains an error code ($<$0)\-: -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset did not point to F\-D\-T\-\_\-\-B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, standard meanings 

References can\-\_\-assume, fdt\-\_\-check\-\_\-node\-\_\-offset\-\_\-(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, fdt\-\_\-offset\-\_\-ptr\-\_\-(), fdt\-\_\-ro\-\_\-probe\-\_\-(), fdt\-\_\-version, fdt\-\_\-node\-\_\-header\-::name, N\-U\-L\-L, strlen(), and strrchr().



Referenced by fdt\-\_\-check\-\_\-full(), fdt\-\_\-get\-\_\-path(), fdt\-\_\-nodename\-\_\-eq\-\_\-(), fdt\-\_\-set\-\_\-name(), get\-\_\-path\-\_\-len(), overlay\-\_\-apply\-\_\-node(), and overlay\-\_\-update\-\_\-local\-\_\-node\-\_\-references().


\begin{DoxyCode}
301 \{
302     \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__node__header}{fdt\_node\_header} *nh = \hyperlink{libfdt__internal_8h_a669df6806fbbdd717cef1c9c821dff06}{fdt\_offset\_ptr\_}(fdt, nodeoffset);
303     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *nameptr;
304     \textcolor{keywordtype}{int} err;
305 
306     \textcolor{keywordflow}{if} (((err = \hyperlink{fdt_8c_a69f9fe649e0c3dccd2eac79dafe54a4a}{fdt\_ro\_probe\_}(fdt)) < 0)
307         || ((err = \hyperlink{fdt_8c_a8f4832389aff9d7c0663b6b70cdd42dd}{fdt\_check\_node\_offset\_}(fdt, nodeoffset)) < 0))
308             \textcolor{keywordflow}{goto} fail;
309 
310     nameptr = nh->\hyperlink{structfdt__node__header_a7b13eaf331db0c09640dc3d208c7efcd}{name};
311 
312     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LATEST) && \hyperlink{libfdt_8h_a13dbe2495fe8e67717bc708c523c781e}{fdt\_version}(fdt) < 0x10) \{
313         \textcolor{comment}{/*}
314 \textcolor{comment}{         * For old FDT versions, match the naming conventions of V16:}
315 \textcolor{comment}{         * give only the leaf name (after all /). The actual tree}
316 \textcolor{comment}{         * contents are loosely checked.}
317 \textcolor{comment}{         */}
318         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *leaf;
319         leaf = \hyperlink{cstd_8c_a0c05a458deff028ef4d4e64059098db4}{strrchr}(nameptr, \textcolor{charliteral}{'/'});
320         \textcolor{keywordflow}{if} (leaf == \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
321             err = -\hyperlink{libfdt_8h_aef7e5f2183c72ef2b4698bb918d8f2f7}{FDT\_ERR\_BADSTRUCTURE};
322             \textcolor{keywordflow}{goto} fail;
323         \}
324         nameptr = leaf+1;
325     \}
326 
327     \textcolor{keywordflow}{if} (len)
328         *len = \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(nameptr);
329 
330     \textcolor{keywordflow}{return} nameptr;
331 
332  fail:
333     \textcolor{keywordflow}{if} (len)
334         *len = err;
335     \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
336 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a7b25d4bc3dd83403a39ef84b8a362bd5}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-path@{fdt\-\_\-get\-\_\-path}}
\index{fdt\-\_\-get\-\_\-path@{fdt\-\_\-get\-\_\-path}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-path}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-get\-\_\-path (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{char $\ast$}]{buf, }
\item[{int}]{buflen}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a7b25d4bc3dd83403a39ef84b8a362bd5}
fdt\-\_\-get\-\_\-path -\/ determine the full path of a node \-: pointer to the device tree blob \-: offset of the node whose path to find \-: character buffer to contain the returned path (will be overwritten) \-: size of the character buffer at buf

\hyperlink{fdt__ro_8c_a7b25d4bc3dd83403a39ef84b8a362bd5}{fdt\-\_\-get\-\_\-path()} computes the full path of the node at offset nodeoffset, and records that path in the buffer at buf.

N\-O\-T\-E\-: This function is expensive, as it must scan the device tree structure from the start to nodeoffset.

returns\-: 0, on success buf contains the absolute path of the node at nodeoffset, as a N\-U\-L-\/terminated string. -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-S\-P\-A\-C\-E, the path of the given node is longer than (bufsize-\/1) characters and will not fit in the given buffer. -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-S\-P\-A\-C\-E, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-get\-\_\-name(), fdt\-\_\-next\-\_\-node(), F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E, and memcpy().



Referenced by overlay\-\_\-symbol\-\_\-update().


\begin{DoxyCode}
560 \{
561     \textcolor{keywordtype}{int} pdepth = 0, p = 0;
562     \textcolor{keywordtype}{int} offset, depth, namelen;
563     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{structfdt__node__header_a7b13eaf331db0c09640dc3d208c7efcd}{name};
564 
565     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
566 
567     \textcolor{keywordflow}{if} (buflen < 2)
568         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a149fb54f14ba915a78319a9570e4eae3}{FDT\_ERR\_NOSPACE};
569 
570     \textcolor{keywordflow}{for} (offset = 0, depth = 0;
571          (offset >= 0) && (offset <= nodeoffset);
572          offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, &depth)) \{
573         \textcolor{keywordflow}{while} (pdepth > depth) \{
574             \textcolor{keywordflow}{do} \{
575                 p--;
576             \} \textcolor{keywordflow}{while} (buf[p-1] != \textcolor{charliteral}{'/'});
577             pdepth--;
578         \}
579 
580         \textcolor{keywordflow}{if} (pdepth >= depth) \{
581             name = \hyperlink{fdt__ro_8c_a22a72941a288c00c88c36164fdc793c0}{fdt\_get\_name}(fdt, offset, &namelen);
582             \textcolor{keywordflow}{if} (!name)
583                 \textcolor{keywordflow}{return} namelen;
584             \textcolor{keywordflow}{if} ((p + namelen + 1) <= buflen) \{
585                 \hyperlink{cstd_8c_a40deeb5b928964e60d97b3b8fd8a9b33}{memcpy}(buf + p, name, namelen);
586                 p += namelen;
587                 buf[p++] = \textcolor{charliteral}{'/'};
588                 pdepth++;
589             \}
590         \}
591 
592         \textcolor{keywordflow}{if} (offset == nodeoffset) \{
593             \textcolor{keywordflow}{if} (pdepth < (depth + 1))
594                 \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a149fb54f14ba915a78319a9570e4eae3}{FDT\_ERR\_NOSPACE};
595 
596             \textcolor{keywordflow}{if} (p > 1) \textcolor{comment}{/* special case so that root path is "/", not "" */}
597                 p--;
598             buf[p] = \textcolor{charliteral}{'\(\backslash\)0'};
599             \textcolor{keywordflow}{return} 0;
600         \}
601     \}
602 
603     \textcolor{keywordflow}{if} ((offset == -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND}) || (offset >= 0))
604         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a5025b6b09a009bd2b516e6a831d7ce72}{FDT\_ERR\_BADOFFSET};
605     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (offset == -\hyperlink{libfdt_8h_a5025b6b09a009bd2b516e6a831d7ce72}{FDT\_ERR\_BADOFFSET})
606         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_aef7e5f2183c72ef2b4698bb918d8f2f7}{FDT\_ERR\_BADSTRUCTURE};
607 
608     \textcolor{keywordflow}{return} offset; \textcolor{comment}{/* error from fdt\_next\_node() */}
609 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a0689bb9f27bdaaa355855425b4eb7149}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-phandle@{fdt\-\_\-get\-\_\-phandle}}
\index{fdt\-\_\-get\-\_\-phandle@{fdt\-\_\-get\-\_\-phandle}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-phandle}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint32\-\_\-t} fdt\-\_\-get\-\_\-phandle (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a0689bb9f27bdaaa355855425b4eb7149}
fdt\-\_\-get\-\_\-phandle -\/ retrieve the phandle of a given node \-: pointer to the device tree blob \-: structure block offset of the node

\hyperlink{fdt__ro_8c_a0689bb9f27bdaaa355855425b4eb7149}{fdt\-\_\-get\-\_\-phandle()} retrieves the phandle of the device tree node at structure block offset nodeoffset.

returns\-: the phandle of the node at nodeoffset, on success (!= 0, != -\/1) 0, if the node has no phandle, or another error occurs 

References fdt32\-\_\-ld\-\_\-(), fdt\-\_\-getprop(), and fdt\-\_\-property\-::len.



Referenced by fdt\-\_\-find\-\_\-max\-\_\-phandle(), fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle(), and overlay\-\_\-fixup\-\_\-one\-\_\-phandle().


\begin{DoxyCode}
509 \{
510     \textcolor{keyword}{const} \hyperlink{libfdt__env_8h_a76887ac8786252752fb3f9a39b21f3af}{fdt32\_t} *php;
511     \textcolor{keywordtype}{int} len;
512 
513     \textcolor{comment}{/* FIXME: This is a bit sub-optimal, since we potentially scan}
514 \textcolor{comment}{     * over all the properties twice. */}
515     php = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, \textcolor{stringliteral}{"phandle"}, &len);
516     \textcolor{keywordflow}{if} (!php || (len != \textcolor{keyword}{sizeof}(*php))) \{
517         php = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, \textcolor{stringliteral}{"linux,phandle"}, &len);
518         \textcolor{keywordflow}{if} (!php || (len != \textcolor{keyword}{sizeof}(*php)))
519             \textcolor{keywordflow}{return} 0;
520     \}
521 
522     \textcolor{keywordflow}{return} \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(php);
523 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a7f394390ede4870838765689941c6e3c}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-property@{fdt\-\_\-get\-\_\-property}}
\index{fdt\-\_\-get\-\_\-property@{fdt\-\_\-get\-\_\-property}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-property}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf fdt\-\_\-property}$\ast$ fdt\-\_\-get\-\_\-property (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{name, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a7f394390ede4870838765689941c6e3c}


References fdt\-\_\-get\-\_\-property\-\_\-namelen(), and strlen().



Referenced by fdt\-\_\-get\-\_\-property\-\_\-w().


\begin{DoxyCode}
446 \{
447     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_ac9739a424852c1400e3c09e5a1bf4364}{fdt\_get\_property\_namelen}(fdt, nodeoffset, 
      \hyperlink{structfdt__node__header_a7b13eaf331db0c09640dc3d208c7efcd}{name},
448                     \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(\hyperlink{structfdt__node__header_a7b13eaf331db0c09640dc3d208c7efcd}{name}), lenp);
449 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a7de37480221a0d3381830233027d32bd}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset@{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset}}
\index{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset@{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf fdt\-\_\-property}$\ast$ fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a7de37480221a0d3381830233027d32bd}
fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset -\/ retrieve the property at a given offset \-: pointer to the device tree blob \-: offset of the property to retrieve \-: pointer to an integer variable (will be overwritten) or N\-U\-L\-L

\hyperlink{fdt__ro_8c_a7de37480221a0d3381830233027d32bd}{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset()} retrieves a pointer to the \hyperlink{structfdt__property}{fdt\-\_\-property} structure within the device tree blob at the given offset. If lenp is non-\/\-N\-U\-L\-L, the length of the property value is also returned, in the integer pointed to by lenp.

Note that this code only works on device tree versions $>$= 16. \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\-\_\-getprop()} works on all versions.

returns\-: pointer to the structure representing the property if lenp is non-\/\-N\-U\-L\-L, $\ast$lenp contains the length of the property value ($>$=0) N\-U\-L\-L, on error if lenp is non-\/\-N\-U\-L\-L, $\ast$lenp contains an error code ($<$0)\-: -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset did not point to F\-D\-T\-\_\-\-P\-R\-O\-P tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings 

References can\-\_\-assume, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-(), fdt\-\_\-version, and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-w().


\begin{DoxyCode}
381 \{
382     \textcolor{comment}{/* Prior to version 16, properties may need realignment}
383 \textcolor{comment}{     * and this API does not work. fdt\_getprop\_*() will, however. */}
384 
385     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LATEST) && \hyperlink{libfdt_8h_a13dbe2495fe8e67717bc708c523c781e}{fdt\_version}(fdt) < 0x10) \{
386         \textcolor{keywordflow}{if} (lenp)
387             *lenp = -\hyperlink{libfdt_8h_ad2a3b277a1e6987ead001fcd2415d88d}{FDT\_ERR\_BADVERSION};
388         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
389     \}
390 
391     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a5968ba67990c99975ff5746c4f80c85a}{fdt\_get\_property\_by\_offset\_}(fdt, offset, lenp);
392 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a5968ba67990c99975ff5746c4f80c85a}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-@{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-}}
\index{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-@{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}static struct {\bf fdt\-\_\-property}$\ast$ fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\- (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_a5968ba67990c99975ff5746c4f80c85a}


References can\-\_\-assume, fdt32\-\_\-ld\-\_\-(), fdt\-\_\-check\-\_\-prop\-\_\-offset\-\_\-(), fdt\-\_\-offset\-\_\-ptr\-\_\-(), fdt\-\_\-property\-::len, and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset(), fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-(), and fdt\-\_\-getprop\-\_\-by\-\_\-offset().


\begin{DoxyCode}
359 \{
360     \textcolor{keywordtype}{int} err;
361     \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__property}{fdt\_property} *prop;
362 
363     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(VALID\_INPUT) &&
364         (err = \hyperlink{fdt_8c_a299827db3d34b686d9ca7f4c60b88a08}{fdt\_check\_prop\_offset\_}(fdt, offset)) < 0) \{
365         \textcolor{keywordflow}{if} (lenp)
366             *lenp = err;
367         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
368     \}
369 
370     prop = \hyperlink{libfdt__internal_8h_a669df6806fbbdd717cef1c9c821dff06}{fdt\_offset\_ptr\_}(fdt, offset);
371 
372     \textcolor{keywordflow}{if} (lenp)
373         *lenp = \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(&prop->\hyperlink{structfdt__property_a48e6236319453578c3ca7c106b382a2f}{len});
374 
375     \textcolor{keywordflow}{return} prop;
376 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_ac9739a424852c1400e3c09e5a1bf4364}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-property\-\_\-namelen@{fdt\-\_\-get\-\_\-property\-\_\-namelen}}
\index{fdt\-\_\-get\-\_\-property\-\_\-namelen@{fdt\-\_\-get\-\_\-property\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-property\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf fdt\-\_\-property}$\ast$ fdt\-\_\-get\-\_\-property\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{const char $\ast$}]{name, }
\item[{int}]{namelen, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_ac9739a424852c1400e3c09e5a1bf4364}


References can\-\_\-assume, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-(), fdt\-\_\-version, and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-property().


\begin{DoxyCode}
429 \{
430     \textcolor{comment}{/* Prior to version 16, properties may need realignment}
431 \textcolor{comment}{     * and this API does not work. fdt\_getprop\_*() will, however. */}
432     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LATEST) && \hyperlink{libfdt_8h_a13dbe2495fe8e67717bc708c523c781e}{fdt\_version}(fdt) < 0x10) \{
433         \textcolor{keywordflow}{if} (lenp)
434             *lenp = -\hyperlink{libfdt_8h_ad2a3b277a1e6987ead001fcd2415d88d}{FDT\_ERR\_BADVERSION};
435         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
436     \}
437 
438     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a3fbd5b94defd29f9e25d8433a03529e9}{fdt\_get\_property\_namelen\_}(fdt, offset, name, namelen, lenp,
439                      \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
440 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a3fbd5b94defd29f9e25d8433a03529e9}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-@{fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-}}
\index{fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-@{fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}static struct {\bf fdt\-\_\-property}$\ast$ fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\- (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{const char $\ast$}]{name, }
\item[{int}]{namelen, }
\item[{int $\ast$}]{lenp, }
\item[{int $\ast$}]{poffset}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_a3fbd5b94defd29f9e25d8433a03529e9}


References can\-\_\-assume, fdt32\-\_\-ld\-\_\-(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-I\-N\-T\-E\-R\-N\-A\-L, fdt\-\_\-first\-\_\-property\-\_\-offset(), fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-(), fdt\-\_\-next\-\_\-property\-\_\-offset(), fdt\-\_\-string\-\_\-eq\-\_\-(), fdt\-\_\-property\-::nameoff, and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-property\-\_\-namelen(), and fdt\-\_\-getprop\-\_\-namelen().


\begin{DoxyCode}
400 \{
401     \textcolor{keywordflow}{for} (offset = \hyperlink{fdt__ro_8c_aba2e2271df9d7cbcbb6ac633bd169bcf}{fdt\_first\_property\_offset}(fdt, offset);
402          (offset >= 0);
403          (offset = \hyperlink{fdt__ro_8c_ad17c7077eebb6668f09aadda1f6c8fb2}{fdt\_next\_property\_offset}(fdt, offset))) \{
404         \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__property}{fdt\_property} *prop;
405 
406         prop = \hyperlink{fdt__ro_8c_a5968ba67990c99975ff5746c4f80c85a}{fdt\_get\_property\_by\_offset\_}(fdt, offset, lenp);
407         \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LIBFDT\_FLAWLESS) && !prop) \{
408             offset = -\hyperlink{libfdt_8h_a02625761a47e8012c53fb389dd25fadd}{FDT\_ERR\_INTERNAL};
409             \textcolor{keywordflow}{break};
410         \}
411         \textcolor{keywordflow}{if} (\hyperlink{fdt__ro_8c_a4bbeefd40ad440c5e41c60cc431fae7a}{fdt\_string\_eq\_}(fdt, \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(&prop->\hyperlink{structfdt__property_ad5753794266beffe67b79b6e5b3ab352}{nameoff}),
412                    name, namelen)) \{
413             \textcolor{keywordflow}{if} (poffset)
414                 *poffset = offset;
415             \textcolor{keywordflow}{return} prop;
416         \}
417     \}
418 
419     \textcolor{keywordflow}{if} (lenp)
420         *lenp = offset;
421     \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
422 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-string@{fdt\-\_\-get\-\_\-string}}
\index{fdt\-\_\-get\-\_\-string@{fdt\-\_\-get\-\_\-string}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-string}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-get\-\_\-string (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{stroffset, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}
fdt\-\_\-get\-\_\-string -\/ retrieve a string from the strings block of a device tree \-: pointer to the device tree blob \-: offset of the string within the strings block (native endian) \-: optional pointer to return the string's length

\hyperlink{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}{fdt\-\_\-get\-\_\-string()} retrieves a pointer to a single string from the strings block of the device tree blob at fdt, and optionally also returns the string's length in $\ast$lenp.

returns\-: a pointer to the string, on success N\-U\-L\-L, if stroffset is out of bounds, or doesn't point to a valid string 

References can\-\_\-assume, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-I\-N\-T\-E\-R\-N\-A\-L, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, F\-D\-T\-\_\-\-M\-A\-G\-I\-C, fdt\-\_\-magic, fdt\-\_\-off\-\_\-dt\-\_\-strings, fdt\-\_\-ro\-\_\-probe\-\_\-(), fdt\-\_\-size\-\_\-dt\-\_\-strings, F\-D\-T\-\_\-\-S\-W\-\_\-\-M\-A\-G\-I\-C, fdt\-\_\-version, memchr(), N\-U\-L\-L, and strlen().



Referenced by fdt\-\_\-getprop\-\_\-by\-\_\-offset(), fdt\-\_\-string(), and fdt\-\_\-string\-\_\-eq\-\_\-().


\begin{DoxyCode}
35 \{
36     \hyperlink{libfdt__env_8h_a32f2e37ee053cf2ce8ca28d1f74630e5}{int32\_t} totalsize;
37     \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} absoffset;
38     \textcolor{keywordtype}{size\_t} \hyperlink{structfdt__property_a48e6236319453578c3ca7c106b382a2f}{len};
39     \textcolor{keywordtype}{int} err;
40     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *s, *n;
41 
42     \textcolor{keywordflow}{if} (\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(VALID\_INPUT)) \{
43         s = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)fdt + \hyperlink{libfdt_8h_a80994b6320a372f47942ac65f55c0d6c}{fdt\_off\_dt\_strings}(fdt) + stroffset;
44 
45         \textcolor{keywordflow}{if} (lenp)
46             *lenp = \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(s);
47         \textcolor{keywordflow}{return} s;
48     \}
49     totalsize = \hyperlink{fdt_8c_a69f9fe649e0c3dccd2eac79dafe54a4a}{fdt\_ro\_probe\_}(fdt);
50     err = totalsize;
51     \textcolor{keywordflow}{if} (totalsize < 0)
52         \textcolor{keywordflow}{goto} fail;
53 
54     err = -\hyperlink{libfdt_8h_a5025b6b09a009bd2b516e6a831d7ce72}{FDT\_ERR\_BADOFFSET};
55     absoffset = stroffset + \hyperlink{libfdt_8h_a80994b6320a372f47942ac65f55c0d6c}{fdt\_off\_dt\_strings}(fdt);
56     \textcolor{keywordflow}{if} (absoffset >= (\textcolor{keywordtype}{unsigned})totalsize)
57         \textcolor{keywordflow}{goto} fail;
58     len = totalsize - absoffset;
59 
60     \textcolor{keywordflow}{if} (\hyperlink{libfdt_8h_a783c67f6971d10232c84ecd0aa76f461}{fdt\_magic}(fdt) == \hyperlink{fdt_8h_a5d5b14eccb44e809abddd8a946ddc8a3}{FDT\_MAGIC}) \{
61         \textcolor{keywordflow}{if} (stroffset < 0)
62             \textcolor{keywordflow}{goto} fail;
63         \textcolor{keywordflow}{if} (\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LATEST) || \hyperlink{libfdt_8h_a13dbe2495fe8e67717bc708c523c781e}{fdt\_version}(fdt) >= 17) \{
64             \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned})stroffset >= \hyperlink{libfdt_8h_aa0748803d707f2be7d15ebfb815d31b4}{fdt\_size\_dt\_strings}(fdt))
65                 \textcolor{keywordflow}{goto} fail;
66             \textcolor{keywordflow}{if} ((\hyperlink{libfdt_8h_aa0748803d707f2be7d15ebfb815d31b4}{fdt\_size\_dt\_strings}(fdt) - stroffset) < len)
67                 len = \hyperlink{libfdt_8h_aa0748803d707f2be7d15ebfb815d31b4}{fdt\_size\_dt\_strings}(fdt) - stroffset;
68         \}
69     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{libfdt_8h_a783c67f6971d10232c84ecd0aa76f461}{fdt\_magic}(fdt) == \hyperlink{libfdt__internal_8h_a8beb41f034bfe7967b246bbad463a575}{FDT\_SW\_MAGIC}) \{
70         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} sw\_stroffset = -stroffset;
71 
72         \textcolor{keywordflow}{if} ((stroffset >= 0) ||
73             (sw\_stroffset > \hyperlink{libfdt_8h_aa0748803d707f2be7d15ebfb815d31b4}{fdt\_size\_dt\_strings}(fdt)))
74             \textcolor{keywordflow}{goto} fail;
75         \textcolor{keywordflow}{if} (sw\_stroffset < len)
76             len = sw\_stroffset;
77     \} \textcolor{keywordflow}{else} \{
78         err = -\hyperlink{libfdt_8h_a02625761a47e8012c53fb389dd25fadd}{FDT\_ERR\_INTERNAL};
79         \textcolor{keywordflow}{goto} fail;
80     \}
81 
82     s = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)fdt + absoffset;
83     n = \hyperlink{cstd_8c_a7a1a96cef371f847b925fb1478e04080}{memchr}(s, \textcolor{charliteral}{'\(\backslash\)0'}, len);
84     \textcolor{keywordflow}{if} (!n) \{
85         \textcolor{comment}{/* missing terminating NULL */}
86         err = -\hyperlink{libfdt_8h_a2b814a0775d93b5da1442fc091e49958}{FDT\_ERR\_TRUNCATED};
87         \textcolor{keywordflow}{goto} fail;
88     \}
89 
90     \textcolor{keywordflow}{if} (lenp)
91         *lenp = n - s;
92     \textcolor{keywordflow}{return} s;
93 
94 fail:
95     \textcolor{keywordflow}{if} (lenp)
96         *lenp = err;
97     \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
98 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a9d7a5c166e18e81722839c0b5a0541ee}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-symbol@{fdt\-\_\-get\-\_\-symbol}}
\index{fdt\-\_\-get\-\_\-symbol@{fdt\-\_\-get\-\_\-symbol}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-symbol}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-get\-\_\-symbol (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a9d7a5c166e18e81722839c0b5a0541ee}


References fdt\-\_\-get\-\_\-symbol\-\_\-namelen(), and strlen().


\begin{DoxyCode}
555 \{
556     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_ab6e268a7c7fef650ee0c08f7010ae914}{fdt\_get\_symbol\_namelen}(fdt, name, \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(name));
557 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_ab6e268a7c7fef650ee0c08f7010ae914}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-get\-\_\-symbol\-\_\-namelen@{fdt\-\_\-get\-\_\-symbol\-\_\-namelen}}
\index{fdt\-\_\-get\-\_\-symbol\-\_\-namelen@{fdt\-\_\-get\-\_\-symbol\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-get\-\_\-symbol\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-get\-\_\-symbol\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{name, }
\item[{int}]{namelen}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_ab6e268a7c7fef650ee0c08f7010ae914}


References fdt\-\_\-path\-\_\-getprop\-\_\-namelen(), and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-symbol().


\begin{DoxyCode}
550 \{
551     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a4f970773c1f5023ddb012f1f5d799c5e}{fdt\_path\_getprop\_namelen}(fdt, \textcolor{stringliteral}{"/\_\_symbols\_\_"}, name, namelen, 
      \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
552 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-getprop@{fdt\-\_\-getprop}}
\index{fdt\-\_\-getprop@{fdt\-\_\-getprop}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-getprop}]{\setlength{\rightskip}{0pt plus 5cm}const void$\ast$ fdt\-\_\-getprop (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{name, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}


References fdt\-\_\-getprop\-\_\-namelen(), and strlen().



Referenced by fdt\-\_\-cells(), fdt\-\_\-get\-\_\-phandle(), fdt\-\_\-getprop\-\_\-w(), fdt\-\_\-node\-\_\-check\-\_\-compatible(), fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value(), fdt\-\_\-overlay\-\_\-target\-\_\-offset(), fdt\-\_\-setprop\-\_\-inplace(), fdt\-\_\-stringlist\-\_\-count(), fdt\-\_\-stringlist\-\_\-get(), fdt\-\_\-stringlist\-\_\-search(), get\-\_\-base\-\_\-address(), get\-\_\-irq(), overlay\-\_\-fixup\-\_\-one\-\_\-phandle(), overlay\-\_\-get\-\_\-target\-\_\-phandle(), overlay\-\_\-phandle\-\_\-add\-\_\-offset(), and overlay\-\_\-update\-\_\-local\-\_\-node\-\_\-references().


\begin{DoxyCode}
504 \{
505     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_af06aa67642c5e97ec636619a4ac3f19a}{fdt\_getprop\_namelen}(fdt, nodeoffset, name, \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(name), lenp);
506 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a631207472dcddda9470f5791260da0fd}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-getprop\-\_\-by\-\_\-offset@{fdt\-\_\-getprop\-\_\-by\-\_\-offset}}
\index{fdt\-\_\-getprop\-\_\-by\-\_\-offset@{fdt\-\_\-getprop\-\_\-by\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-getprop\-\_\-by\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}const void$\ast$ fdt\-\_\-getprop\-\_\-by\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{const char $\ast$$\ast$}]{namep, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a631207472dcddda9470f5791260da0fd}
fdt\-\_\-getprop\-\_\-by\-\_\-offset -\/ retrieve the value of a property at a given offset \-: pointer to the device tree blob \-: offset of the property to read \-: pointer to a string variable (will be overwritten) or N\-U\-L\-L \-: pointer to an integer variable (will be overwritten) or N\-U\-L\-L

\hyperlink{fdt__ro_8c_a631207472dcddda9470f5791260da0fd}{fdt\-\_\-getprop\-\_\-by\-\_\-offset()} retrieves a pointer to the value of the property at structure block offset 'offset' (this will be a pointer to within the device blob itself, not a copy of the value). If lenp is non-\/\-N\-U\-L\-L, the length of the property value is also returned, in the integer pointed to by lenp. If namep is non-\/\-N\-U\-L\-L, the property's namne will also be returned in the char $\ast$ pointed to by namep (this will be a pointer to within the device tree's string block, not a new copy of the name).

returns\-: pointer to the property's value if lenp is non-\/\-N\-U\-L\-L, $\ast$lenp contains the length of the property value ($>$=0) if namep is non-\/\-N\-U\-L\-L $\ast$namep contiains a pointer to the property name. N\-U\-L\-L, on error if lenp is non-\/\-N\-U\-L\-L, $\ast$lenp contains an error code ($<$0)\-: -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset did not point to F\-D\-T\-\_\-\-P\-R\-O\-P tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings 

References can\-\_\-assume, fdt\-\_\-property\-::data, fdt32\-\_\-ld\-\_\-(), fdt\-\_\-get\-\_\-property\-\_\-by\-\_\-offset\-\_\-(), fdt\-\_\-get\-\_\-string(), fdt\-\_\-string(), fdt\-\_\-version, fdt\-\_\-property\-::len, fdt\-\_\-property\-::nameoff, and N\-U\-L\-L.



Referenced by fdt\-\_\-check\-\_\-full(), overlay\-\_\-apply\-\_\-node(), overlay\-\_\-fixup\-\_\-phandle(), overlay\-\_\-symbol\-\_\-update(), and overlay\-\_\-update\-\_\-local\-\_\-node\-\_\-references().


\begin{DoxyCode}
471 \{
472     \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__property}{fdt\_property} *prop;
473 
474     prop = \hyperlink{fdt__ro_8c_a5968ba67990c99975ff5746c4f80c85a}{fdt\_get\_property\_by\_offset\_}(fdt, offset, lenp);
475     \textcolor{keywordflow}{if} (!prop)
476         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
477     \textcolor{keywordflow}{if} (namep) \{
478         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *name;
479         \textcolor{keywordtype}{int} namelen;
480 
481         \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(VALID\_INPUT)) \{
482             name = \hyperlink{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}{fdt\_get\_string}(fdt, \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(&prop->
      \hyperlink{structfdt__property_ad5753794266beffe67b79b6e5b3ab352}{nameoff}),
483                           &namelen);
484             *namep = name;
485             \textcolor{keywordflow}{if} (!name) \{
486                 \textcolor{keywordflow}{if} (lenp)
487                     *lenp = namelen;
488                 \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
489             \}
490         \} \textcolor{keywordflow}{else} \{
491             *namep = \hyperlink{fdt__ro_8c_a5ccdba67e9d56872ef16dcbd405da94a}{fdt\_string}(fdt, \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(&prop->\hyperlink{structfdt__property_ad5753794266beffe67b79b6e5b3ab352}{nameoff}));
492         \}
493     \}
494 
495     \textcolor{comment}{/* Handle realignment */}
496     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LATEST) && \hyperlink{libfdt_8h_a13dbe2495fe8e67717bc708c523c781e}{fdt\_version}(fdt) < 0x10 &&
497         (offset + \textcolor{keyword}{sizeof}(*prop)) % 8 && \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(&prop->\hyperlink{structfdt__property_a48e6236319453578c3ca7c106b382a2f}{len}) >= 8)
498         \textcolor{keywordflow}{return} prop->\hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data} + 4;
499     \textcolor{keywordflow}{return} prop->\hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data};
500 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_af06aa67642c5e97ec636619a4ac3f19a}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-getprop\-\_\-namelen@{fdt\-\_\-getprop\-\_\-namelen}}
\index{fdt\-\_\-getprop\-\_\-namelen@{fdt\-\_\-getprop\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-getprop\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}const void$\ast$ fdt\-\_\-getprop\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{name, }
\item[{int}]{namelen, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_af06aa67642c5e97ec636619a4ac3f19a}


References can\-\_\-assume, fdt\-\_\-property\-::data, fdt32\-\_\-ld\-\_\-(), fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-(), fdt\-\_\-version, fdt\-\_\-property\-::len, and N\-U\-L\-L.



Referenced by fdt\-\_\-getprop(), fdt\-\_\-getprop\-\_\-namelen\-\_\-w(), and fdt\-\_\-path\-\_\-getprop\-\_\-namelen().


\begin{DoxyCode}
453 \{
454     \textcolor{keywordtype}{int} poffset;
455     \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__property}{fdt\_property} *prop;
456 
457     prop = \hyperlink{fdt__ro_8c_a3fbd5b94defd29f9e25d8433a03529e9}{fdt\_get\_property\_namelen\_}(fdt, nodeoffset, name, namelen, lenp,
458                      &poffset);
459     \textcolor{keywordflow}{if} (!prop)
460         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
461 
462     \textcolor{comment}{/* Handle realignment */}
463     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LATEST) && \hyperlink{libfdt_8h_a13dbe2495fe8e67717bc708c523c781e}{fdt\_version}(fdt) < 0x10 &&
464         (poffset + \textcolor{keyword}{sizeof}(*prop)) % 8 && \hyperlink{libfdt__internal_8h_a066e0e174590b6a1a34eef6a0c777710}{fdt32\_ld\_}(&prop->\hyperlink{structfdt__property_a48e6236319453578c3ca7c106b382a2f}{len}) >= 8)
465         \textcolor{keywordflow}{return} prop->\hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data} + 4;
466     \textcolor{keywordflow}{return} prop->\hyperlink{structfdt__property_abb52f21622f86ed9b268f49b76f23aef}{data};
467 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_aa26d083555e092c1fc4f07a452502eb4}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-mem\-\_\-rsv@{fdt\-\_\-mem\-\_\-rsv}}
\index{fdt\-\_\-mem\-\_\-rsv@{fdt\-\_\-mem\-\_\-rsv}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-mem\-\_\-rsv}]{\setlength{\rightskip}{0pt plus 5cm}static struct {\bf fdt\-\_\-reserve\-\_\-entry}$\ast$ fdt\-\_\-mem\-\_\-rsv (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{n}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_aa26d083555e092c1fc4f07a452502eb4}


References can\-\_\-assume, fdt\-\_\-mem\-\_\-rsv\-\_\-(), fdt\-\_\-off\-\_\-mem\-\_\-rsvmap, fdt\-\_\-totalsize, and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-mem\-\_\-rsv(), and fdt\-\_\-num\-\_\-mem\-\_\-rsv().


\begin{DoxyCode}
161 \{
162     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} offset = n * \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{structfdt__reserve__entry}{fdt\_reserve\_entry});
163     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} absoffset = \hyperlink{libfdt_8h_ad34e2939365df0a17061d177356b4e39}{fdt\_off\_mem\_rsvmap}(fdt) + offset;
164 
165     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(VALID\_INPUT)) \{
166         \textcolor{keywordflow}{if} (absoffset < \hyperlink{libfdt_8h_ad34e2939365df0a17061d177356b4e39}{fdt\_off\_mem\_rsvmap}(fdt))
167             \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
168         \textcolor{keywordflow}{if} (absoffset > \hyperlink{libfdt_8h_a2acbb1f436008e0830f7e329bbb13cd0}{fdt\_totalsize}(fdt) -
169             \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structfdt__reserve__entry}{fdt\_reserve\_entry}))
170             \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
171     \}
172     \textcolor{keywordflow}{return} \hyperlink{libfdt__internal_8h_ac64edb5a2b383f975d498c4cad5ee81f}{fdt\_mem\_rsv\_}(fdt, n);
173 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_ad17c7077eebb6668f09aadda1f6c8fb2}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-next\-\_\-property\-\_\-offset@{fdt\-\_\-next\-\_\-property\-\_\-offset}}
\index{fdt\-\_\-next\-\_\-property\-\_\-offset@{fdt\-\_\-next\-\_\-property\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-next\-\_\-property\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-next\-\_\-property\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_ad17c7077eebb6668f09aadda1f6c8fb2}
fdt\-\_\-next\-\_\-property\-\_\-offset -\/ step through a node's properties \-: pointer to the device tree blob \-: structure block offset of a property

\hyperlink{fdt__ro_8c_ad17c7077eebb6668f09aadda1f6c8fb2}{fdt\-\_\-next\-\_\-property\-\_\-offset()} finds the property immediately after the one at the given structure block offset. This will be a property of the same node as the given property.

returns\-: structure block offset of the next property ($>$=0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, if the given property is the last in its node -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, if nodeoffset did not point to an F\-D\-T\-\_\-\-P\-R\-O\-P tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings. 

References fdt\-\_\-check\-\_\-prop\-\_\-offset\-\_\-(), and nextprop\-\_\-().



Referenced by fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-().


\begin{DoxyCode}
349 \{
350     \textcolor{keywordflow}{if} ((offset = \hyperlink{fdt_8c_a299827db3d34b686d9ca7f4c60b88a08}{fdt\_check\_prop\_offset\_}(fdt, offset)) < 0)
351         \textcolor{keywordflow}{return} offset;
352 
353     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a0a233378abbb816de0249098cb2fc450}{nextprop\_}(fdt, offset);
354 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_ade07583ac432de46013acb3a07eca7be}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-node\-\_\-check\-\_\-compatible@{fdt\-\_\-node\-\_\-check\-\_\-compatible}}
\index{fdt\-\_\-node\-\_\-check\-\_\-compatible@{fdt\-\_\-node\-\_\-check\-\_\-compatible}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-node\-\_\-check\-\_\-compatible}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-node\-\_\-check\-\_\-compatible (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{compatible}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_ade07583ac432de46013acb3a07eca7be}
fdt\-\_\-node\-\_\-check\-\_\-compatible -\/ check a node's compatible property \-: pointer to the device tree blob \-: offset of a tree node \-: string to match against

\hyperlink{fdt__ro_8c_ade07583ac432de46013acb3a07eca7be}{fdt\-\_\-node\-\_\-check\-\_\-compatible()} returns 0 if the given node contains a  property with the given string as one of its elements, it returns non-\/zero otherwise, or on error.

returns\-: 0, if the node has a 'compatible' property listing the given string 1, if the node has a 'compatible' property, but it does not list the given string -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, if the given node has no 'compatible' property -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, if nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References fdt\-\_\-getprop(), fdt\-\_\-stringlist\-\_\-contains(), and fdt\-\_\-property\-::len.



Referenced by fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible().


\begin{DoxyCode}
842 \{
843     \textcolor{keyword}{const} \textcolor{keywordtype}{void} *prop;
844     \textcolor{keywordtype}{int} len;
845 
846     prop = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, \textcolor{stringliteral}{"compatible"}, &len);
847     \textcolor{keywordflow}{if} (!prop)
848         \textcolor{keywordflow}{return} len;
849 
850     \textcolor{keywordflow}{return} !\hyperlink{fdt__ro_8c_a2492648af0491398295fac892cb8b758}{fdt\_stringlist\_contains}(prop, len, compatible);
851 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a2c0d12a5988128f0b674d4ec24b709d8}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-node\-\_\-depth@{fdt\-\_\-node\-\_\-depth}}
\index{fdt\-\_\-node\-\_\-depth@{fdt\-\_\-node\-\_\-depth}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-node\-\_\-depth}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-node\-\_\-depth (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a2c0d12a5988128f0b674d4ec24b709d8}
fdt\-\_\-node\-\_\-depth -\/ find the depth of a given node \-: pointer to the device tree blob \-: offset of the node whose parent to find

\hyperlink{fdt__ro_8c_a2c0d12a5988128f0b674d4ec24b709d8}{fdt\-\_\-node\-\_\-depth()} finds the depth of a given node. The root node has depth 0, its immediate subnodes depth 1 and so forth.

N\-O\-T\-E\-: This function is expensive, as it must scan the device tree structure from the start to nodeoffset.

returns\-: depth of the node at nodeoffset ($>$=0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References can\-\_\-assume, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-I\-N\-T\-E\-R\-N\-A\-L, and fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset().



Referenced by fdt\-\_\-parent\-\_\-offset().


\begin{DoxyCode}
650 \{
651     \textcolor{keywordtype}{int} nodedepth;
652     \textcolor{keywordtype}{int} err;
653 
654     err = \hyperlink{fdt__ro_8c_a6c960d975c6644172ccc71fc2c48dbb4}{fdt\_supernode\_atdepth\_offset}(fdt, nodeoffset, 0, &nodedepth);
655     \textcolor{keywordflow}{if} (err)
656         \textcolor{keywordflow}{return} (\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(LIBFDT\_FLAWLESS) || err < 0) ? err :
657             -\hyperlink{libfdt_8h_a02625761a47e8012c53fb389dd25fadd}{FDT\_ERR\_INTERNAL};
658     \textcolor{keywordflow}{return} nodedepth;
659 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a7fee20e876e2af4dd32e987c6c8f104a}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible@{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible}}
\index{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible@{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{startoffset, }
\item[{const char $\ast$}]{compatible}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a7fee20e876e2af4dd32e987c6c8f104a}
fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible -\/ find nodes with a given 'compatible' value \-: pointer to the device tree blob \-: only find nodes after this offset \-: 'compatible' string to match against

\hyperlink{fdt__ro_8c_a7fee20e876e2af4dd32e987c6c8f104a}{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible()} returns the offset of the first node after startoffset, which has a 'compatible' property which lists the given compatible string; or if startoffset is -\/1, the very first such node in the tree.

To iterate through all nodes matching the criterion, the following idiom can be used\-: offset = fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible(fdt, -\/1, compatible); while (offset != -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D) \{ // other code here offset = fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-compatible(fdt, offset, compatible); \}

Note the -\/1 in the first call to the function, if 0 is used here instead, the function will never locate the root node, even if it matches the criterion.

returns\-: structure block offset of the located node ($>$= 0, $>$startoffset), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, no node matching the criterion exists in the tree after startoffset -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-next\-\_\-node(), fdt\-\_\-node\-\_\-check\-\_\-compatible(), F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E, and N\-U\-L\-L.



Referenced by soc\-\_\-dma\-\_\-init(), soc\-\_\-icu\-\_\-init(), soc\-\_\-timer\-\_\-init(), and soc\-\_\-tty\-\_\-init().


\begin{DoxyCode}
855 \{
856     \textcolor{keywordtype}{int} offset, err;
857 
858     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
859 
860     \textcolor{comment}{/* FIXME: The algorithm here is pretty horrible: we scan each}
861 \textcolor{comment}{     * property of a node in fdt\_node\_check\_compatible(), then if}
862 \textcolor{comment}{     * that didn't find what we want, we scan over them again}
863 \textcolor{comment}{     * making our way to the next node.  Still it's the easiest to}
864 \textcolor{comment}{     * implement approach; performance can come later. */}
865     \textcolor{keywordflow}{for} (offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, startoffset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
866          offset >= 0;
867          offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})) \{
868         err = \hyperlink{fdt__ro_8c_ade07583ac432de46013acb3a07eca7be}{fdt\_node\_check\_compatible}(fdt, offset, compatible);
869         \textcolor{keywordflow}{if} ((err < 0) && (err != -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND}))
870             \textcolor{keywordflow}{return} err;
871         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (err == 0)
872             \textcolor{keywordflow}{return} offset;
873     \}
874 
875     \textcolor{keywordflow}{return} offset; \textcolor{comment}{/* error from fdt\_next\_node() */}
876 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a4ff6571f3fe2fa89cfd6dc15f52eaf1e}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle@{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle}}
\index{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle@{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{{\bf uint32\-\_\-t}}]{phandle}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a4ff6571f3fe2fa89cfd6dc15f52eaf1e}
fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle -\/ find the node with a given phandle \-: pointer to the device tree blob \-: phandle value

\hyperlink{fdt__ro_8c_a4ff6571f3fe2fa89cfd6dc15f52eaf1e}{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-phandle()} returns the offset of the node which has the given phandle value. If there is more than one node in the tree with the given phandle (an invalid tree), results are undefined.

returns\-: structure block offset of the located node ($>$= 0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, no node with that phandle exists -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-P\-H\-A\-N\-D\-L\-E, given phandle value was invalid (0 or -\/1) -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-P\-H\-A\-N\-D\-L\-E, fdt\-\_\-get\-\_\-phandle(), fdt\-\_\-next\-\_\-node(), F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E, and N\-U\-L\-L.



Referenced by fdt\-\_\-overlay\-\_\-target\-\_\-offset().


\begin{DoxyCode}
699 \{
700     \textcolor{keywordtype}{int} offset;
701 
702     \textcolor{keywordflow}{if} ((phandle == 0) || (phandle == ~0U))
703         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a0f264f8ba8cc4e98852c8246bc6312bc}{FDT\_ERR\_BADPHANDLE};
704 
705     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
706 
707     \textcolor{comment}{/* FIXME: The algorithm here is pretty horrible: we}
708 \textcolor{comment}{     * potentially scan each property of a node in}
709 \textcolor{comment}{     * fdt\_get\_phandle(), then if that didn't find what}
710 \textcolor{comment}{     * we want, we scan over them again making our way to the next}
711 \textcolor{comment}{     * node.  Still it's the easiest to implement approach;}
712 \textcolor{comment}{     * performance can come later. */}
713     \textcolor{keywordflow}{for} (offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, -1, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
714          offset >= 0;
715          offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})) \{
716         \textcolor{keywordflow}{if} (\hyperlink{fdt__ro_8c_a0689bb9f27bdaaa355855425b4eb7149}{fdt\_get\_phandle}(fdt, offset) == phandle)
717             \textcolor{keywordflow}{return} offset;
718     \}
719 
720     \textcolor{keywordflow}{return} offset; \textcolor{comment}{/* error from fdt\_next\_node() */}
721 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a99d317b082102ce9a3eea47e86ab5757}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value@{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value}}
\index{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value@{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{startoffset, }
\item[{const char $\ast$}]{propname, }
\item[{const void $\ast$}]{propval, }
\item[{int}]{proplen}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a99d317b082102ce9a3eea47e86ab5757}
fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value -\/ find nodes with a given property value \-: pointer to the device tree blob \-: only find nodes after this offset \-: property name to check \-: property value to search for \-: length of the value in propval

\hyperlink{fdt__ro_8c_a99d317b082102ce9a3eea47e86ab5757}{fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value()} returns the offset of the first node after startoffset, which has a property named propname whose value is of length proplen and has value equal to propval; or if startoffset is -\/1, the very first such node in the tree.

To iterate through all nodes matching the criterion, the following idiom can be used\-: offset = fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value(fdt, -\/1, propname, propval, proplen); while (offset != -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D) \{ // other code here offset = fdt\-\_\-node\-\_\-offset\-\_\-by\-\_\-prop\-\_\-value(fdt, offset, propname, propval, proplen); \}

Note the -\/1 in the first call to the function, if 0 is used here instead, the function will never locate the root node, even if it matches the criterion.

returns\-: structure block offset of the located node ($>$= 0, $>$startoffset), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, no node matching the criterion exists in the tree after startoffset -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References fdt\-\_\-getprop(), fdt\-\_\-next\-\_\-node(), F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E, fdt\-\_\-property\-::len, memcmp(), and N\-U\-L\-L.


\begin{DoxyCode}
674 \{
675     \textcolor{keywordtype}{int} offset;
676     \textcolor{keyword}{const} \textcolor{keywordtype}{void} *val;
677     \textcolor{keywordtype}{int} len;
678 
679     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
680 
681     \textcolor{comment}{/* FIXME: The algorithm here is pretty horrible: we scan each}
682 \textcolor{comment}{     * property of a node in fdt\_getprop(), then if that didn't}
683 \textcolor{comment}{     * find what we want, we scan over them again making our way}
684 \textcolor{comment}{     * to the next node.  Still it's the easiest to implement}
685 \textcolor{comment}{     * approach; performance can come later. */}
686     \textcolor{keywordflow}{for} (offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, startoffset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
687          offset >= 0;
688          offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL})) \{
689         val = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, offset, propname, &len);
690         \textcolor{keywordflow}{if} (val && (len == proplen)
691             && (\hyperlink{cstd_8c_ace6c4869ab3af01c6f27eac47773917a}{memcmp}(val, propval, len) == 0))
692             \textcolor{keywordflow}{return} offset;
693     \}
694 
695     \textcolor{keywordflow}{return} offset; \textcolor{comment}{/* error from fdt\_next\_node() */}
696 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a2d417f67da75b1ebf2871428d952cf8f}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-nodename\-\_\-eq\-\_\-@{fdt\-\_\-nodename\-\_\-eq\-\_\-}}
\index{fdt\-\_\-nodename\-\_\-eq\-\_\-@{fdt\-\_\-nodename\-\_\-eq\-\_\-}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-nodename\-\_\-eq\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}static int fdt\-\_\-nodename\-\_\-eq\-\_\- (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{const char $\ast$}]{s, }
\item[{int}]{len}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_a2d417f67da75b1ebf2871428d952cf8f}


References fdt\-\_\-get\-\_\-name(), memchr(), and memcmp().



Referenced by fdt\-\_\-subnode\-\_\-offset\-\_\-namelen().


\begin{DoxyCode}
15 \{
16     \textcolor{keywordtype}{int} olen;
17     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *p = \hyperlink{fdt__ro_8c_a22a72941a288c00c88c36164fdc793c0}{fdt\_get\_name}(fdt, offset, &olen);
18 
19     \textcolor{keywordflow}{if} (!p || olen < len)
20         \textcolor{comment}{/* short match */}
21         \textcolor{keywordflow}{return} 0;
22 
23     \textcolor{keywordflow}{if} (\hyperlink{cstd_8c_ace6c4869ab3af01c6f27eac47773917a}{memcmp}(p, s, len) != 0)
24         \textcolor{keywordflow}{return} 0;
25 
26     \textcolor{keywordflow}{if} (p[len] == \textcolor{charliteral}{'\(\backslash\)0'})
27         \textcolor{keywordflow}{return} 1;
28     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{cstd_8c_a7a1a96cef371f847b925fb1478e04080}{memchr}(s, \textcolor{charliteral}{'@'}, len) && (p[len] == \textcolor{charliteral}{'@'}))
29         \textcolor{keywordflow}{return} 1;
30     \textcolor{keywordflow}{else}
31         \textcolor{keywordflow}{return} 0;
32 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a79fa5b76564c75c9fb00fe8ca3ba3eee}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-num\-\_\-mem\-\_\-rsv@{fdt\-\_\-num\-\_\-mem\-\_\-rsv}}
\index{fdt\-\_\-num\-\_\-mem\-\_\-rsv@{fdt\-\_\-num\-\_\-mem\-\_\-rsv}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-num\-\_\-mem\-\_\-rsv}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-num\-\_\-mem\-\_\-rsv (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a79fa5b76564c75c9fb00fe8ca3ba3eee}
fdt\-\_\-num\-\_\-mem\-\_\-rsv -\/ retrieve the number of memory reserve map entries \-: pointer to the device tree blob

Returns the number of entries in the device tree blob's memory reservation map. This does not include the terminating 0,0 entry or any other (0,0) entries reserved for expansion.

returns\-: the number of entries 

References fdt64\-\_\-ld\-\_\-(), F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, fdt\-\_\-mem\-\_\-rsv(), N\-U\-L\-L, and fdt\-\_\-reserve\-\_\-entry\-::size.



Referenced by fdt\-\_\-add\-\_\-mem\-\_\-rsv(), fdt\-\_\-check\-\_\-full(), fdt\-\_\-del\-\_\-mem\-\_\-rsv(), fdt\-\_\-open\-\_\-into(), and fdt\-\_\-pack().


\begin{DoxyCode}
190 \{
191     \textcolor{keywordtype}{int} i;
192     \textcolor{keyword}{const} \textcolor{keyword}{struct }\hyperlink{structfdt__reserve__entry}{fdt\_reserve\_entry} *re;
193 
194     \textcolor{keywordflow}{for} (i = 0; (re = \hyperlink{fdt__ro_8c_aa26d083555e092c1fc4f07a452502eb4}{fdt\_mem\_rsv}(fdt, i)) != \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}; i++) \{
195         \textcolor{keywordflow}{if} (\hyperlink{libfdt__internal_8h_af075236a40c956f7e24e7ba5235f35ce}{fdt64\_ld\_}(&re->\hyperlink{structfdt__reserve__entry_ace12399f157bc46877fbcddec98da67e}{size}) == 0)
196             \textcolor{keywordflow}{return} i;
197     \}
198     \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a2b814a0775d93b5da1442fc091e49958}{FDT\_ERR\_TRUNCATED};
199 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a2b518dbd88cb783a9bffa1680ab297f9}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-parent\-\_\-offset@{fdt\-\_\-parent\-\_\-offset}}
\index{fdt\-\_\-parent\-\_\-offset@{fdt\-\_\-parent\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-parent\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-parent\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a2b518dbd88cb783a9bffa1680ab297f9}
fdt\-\_\-parent\-\_\-offset -\/ find the parent of a given node \-: pointer to the device tree blob \-: offset of the node whose parent to find

\hyperlink{fdt__ro_8c_a2b518dbd88cb783a9bffa1680ab297f9}{fdt\-\_\-parent\-\_\-offset()} locates the parent node of a given node (that is, it finds the offset of the node which contains the node at nodeoffset as a subnode).

N\-O\-T\-E\-: This function is expensive, as it must scan the device tree structure from the start to nodeoffset, {\itshape twice}.

returns\-: structure block offset of the parent of the node at nodeoffset ($>$=0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References fdt\-\_\-node\-\_\-depth(), fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset(), and N\-U\-L\-L.



Referenced by get\-\_\-path\-\_\-len().


\begin{DoxyCode}
662 \{
663     \textcolor{keywordtype}{int} nodedepth = \hyperlink{fdt__ro_8c_a2c0d12a5988128f0b674d4ec24b709d8}{fdt\_node\_depth}(fdt, nodeoffset);
664 
665     \textcolor{keywordflow}{if} (nodedepth < 0)
666         \textcolor{keywordflow}{return} nodedepth;
667     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a6c960d975c6644172ccc71fc2c48dbb4}{fdt\_supernode\_atdepth\_offset}(fdt, nodeoffset,
668                         nodedepth - 1, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
669 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a4f970773c1f5023ddb012f1f5d799c5e}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-path\-\_\-getprop\-\_\-namelen@{fdt\-\_\-path\-\_\-getprop\-\_\-namelen}}
\index{fdt\-\_\-path\-\_\-getprop\-\_\-namelen@{fdt\-\_\-path\-\_\-getprop\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-path\-\_\-getprop\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}static const void$\ast$ fdt\-\_\-path\-\_\-getprop\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{path, }
\item[{const char $\ast$}]{propname, }
\item[{int}]{propnamelen, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_a4f970773c1f5023ddb012f1f5d799c5e}


References fdt\-\_\-getprop\-\_\-namelen(), fdt\-\_\-path\-\_\-offset(), and N\-U\-L\-L.



Referenced by fdt\-\_\-get\-\_\-alias\-\_\-namelen(), and fdt\-\_\-get\-\_\-symbol\-\_\-namelen().


\begin{DoxyCode}
528 \{
529     \textcolor{keywordtype}{int} offset = \hyperlink{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}{fdt\_path\_offset}(fdt, path);
530 
531     \textcolor{keywordflow}{if} (offset < 0)
532         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
533 
534     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_af06aa67642c5e97ec636619a4ac3f19a}{fdt\_getprop\_namelen}(fdt, offset, propname, propnamelen, lenp);
535 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-path\-\_\-offset@{fdt\-\_\-path\-\_\-offset}}
\index{fdt\-\_\-path\-\_\-offset@{fdt\-\_\-path\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-path\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-path\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{path}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}
fdt\-\_\-path\-\_\-offset -\/ find a tree node by its full path \-: pointer to the device tree blob \-: full path of the node to locate

\hyperlink{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}{fdt\-\_\-path\-\_\-offset()} finds a node of a given path in the device tree. Each path component may omit the unit address portion, but the results of this are undefined if any such path component is ambiguous (that is if there are multiple nodes at the relevant level matching the given component, differentiated only by unit address).

If the path is not absolute (i.\-e. does not begin with '/'), the first component is treated as an alias. That is, the property by that name is looked up in the /aliases node, and the value of that property used in place of that first component.

For example, for this small fragment

/ \{ aliases \{ i2c2 =  // R\-H\-S compiles to \char`\"{}/soc@0/i2c@30a40000/eeprom@52\char`\"{} \}; soc@0 \{ foo\-: i2c@30a40000 \{ bar\-: eeprom@52 \{ \}; \}; \}; \};

these would be equivalent\-:

/soc@0/i2c@30a40000/eeprom@52 i2c2/eeprom@52

returns\-: structure block offset of the node with the requested path ($>$=0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-P\-A\-T\-H, given path does not begin with '/' and the first component is not a valid alias -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, if the requested node does not exist -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-T\-R\-U\-N\-C\-A\-T\-E\-D, standard meanings. 

References fdt\-\_\-path\-\_\-offset\-\_\-namelen(), and strlen().



Referenced by fdt\-\_\-overlay\-\_\-target\-\_\-offset(), fdt\-\_\-path\-\_\-getprop\-\_\-namelen(), fdt\-\_\-path\-\_\-offset\-\_\-namelen(), overlay\-\_\-fixup\-\_\-one\-\_\-phandle(), overlay\-\_\-fixup\-\_\-phandles(), and overlay\-\_\-update\-\_\-local\-\_\-references().


\begin{DoxyCode}
296 \{
297     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_aa8b4d143366fc7d443f47c1c92a8f8cc}{fdt\_path\_offset\_namelen}(fdt, path, \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(path));
298 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_aa8b4d143366fc7d443f47c1c92a8f8cc}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-path\-\_\-offset\-\_\-namelen@{fdt\-\_\-path\-\_\-offset\-\_\-namelen}}
\index{fdt\-\_\-path\-\_\-offset\-\_\-namelen@{fdt\-\_\-path\-\_\-offset\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-path\-\_\-offset\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-path\-\_\-offset\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{const char $\ast$}]{path, }
\item[{int}]{namelen}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_aa8b4d143366fc7d443f47c1c92a8f8cc}
fdt\-\_\-path\-\_\-offset\-\_\-namelen -\/ find a tree node by its full path \-: pointer to the device tree blob \-: full path of the node to locate \-: number of characters of path to consider

Identical to \hyperlink{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}{fdt\-\_\-path\-\_\-offset()}, but only consider the first namelen characters of path as the path name.

Return\-: offset of the node or negative libfdt error value otherwise 

References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-P\-A\-T\-H, fdt\-\_\-get\-\_\-alias\-\_\-namelen(), fdt\-\_\-path\-\_\-offset(), F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E, fdt\-\_\-subnode\-\_\-offset\-\_\-namelen(), and memchr().



Referenced by fdt\-\_\-path\-\_\-offset(), and overlay\-\_\-fixup\-\_\-one\-\_\-phandle().


\begin{DoxyCode}
251 \{
252     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *end = path + namelen;
253     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *p = path;
254     \textcolor{keywordtype}{int} offset = 0;
255 
256     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
257 
258     \textcolor{comment}{/* see if we have an alias */}
259     \textcolor{keywordflow}{if} (*path != \textcolor{charliteral}{'/'}) \{
260         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *q = \hyperlink{cstd_8c_a7a1a96cef371f847b925fb1478e04080}{memchr}(path, \textcolor{charliteral}{'/'}, end - p);
261 
262         \textcolor{keywordflow}{if} (!q)
263             q = end;
264 
265         p = \hyperlink{fdt__ro_8c_a1446c9a325c1348d88007632675f2641}{fdt\_get\_alias\_namelen}(fdt, p, q - p);
266         \textcolor{keywordflow}{if} (!p)
267             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a2b7c103b35891f65523585a43b92a748}{FDT\_ERR\_BADPATH};
268         offset = \hyperlink{fdt__ro_8c_a222c01ef0a514a4cf7586f6de8b17072}{fdt\_path\_offset}(fdt, p);
269 
270         p = q;
271     \}
272 
273     \textcolor{keywordflow}{while} (p < end) \{
274         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *q;
275 
276         \textcolor{keywordflow}{while} (*p == \textcolor{charliteral}{'/'}) \{
277             p++;
278             \textcolor{keywordflow}{if} (p == end)
279                 \textcolor{keywordflow}{return} offset;
280         \}
281         q = \hyperlink{cstd_8c_a7a1a96cef371f847b925fb1478e04080}{memchr}(p, \textcolor{charliteral}{'/'}, end - p);
282         \textcolor{keywordflow}{if} (! q)
283             q = end;
284 
285         offset = \hyperlink{fdt__ro_8c_a515ddadab660b50e9d31c05c74f7d351}{fdt\_subnode\_offset\_namelen}(fdt, offset, p, q-p);
286         \textcolor{keywordflow}{if} (offset < 0)
287             \textcolor{keywordflow}{return} offset;
288 
289         p = q;
290     \}
291 
292     \textcolor{keywordflow}{return} offset;
293 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a5ccdba67e9d56872ef16dcbd405da94a}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-string@{fdt\-\_\-string}}
\index{fdt\-\_\-string@{fdt\-\_\-string}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-string}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-string (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{stroffset}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a5ccdba67e9d56872ef16dcbd405da94a}
fdt\-\_\-string -\/ retrieve a string from the strings block of a device tree \-: pointer to the device tree blob \-: offset of the string within the strings block (native endian)

\hyperlink{fdt__ro_8c_a5ccdba67e9d56872ef16dcbd405da94a}{fdt\-\_\-string()} retrieves a pointer to a single string from the strings block of the device tree blob at fdt.

returns\-: a pointer to the string, on success N\-U\-L\-L, if stroffset is out of bounds, or doesn't point to a valid string 

References fdt\-\_\-get\-\_\-string(), and N\-U\-L\-L.



Referenced by fdt\-\_\-getprop\-\_\-by\-\_\-offset().


\begin{DoxyCode}
101 \{
102     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}{fdt\_get\_string}(fdt, stroffset, \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
103 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a4bbeefd40ad440c5e41c60cc431fae7a}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-string\-\_\-eq\-\_\-@{fdt\-\_\-string\-\_\-eq\-\_\-}}
\index{fdt\-\_\-string\-\_\-eq\-\_\-@{fdt\-\_\-string\-\_\-eq\-\_\-}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-string\-\_\-eq\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}static int fdt\-\_\-string\-\_\-eq\-\_\- (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{stroffset, }
\item[{const char $\ast$}]{s, }
\item[{int}]{len}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_a4bbeefd40ad440c5e41c60cc431fae7a}


References fdt\-\_\-get\-\_\-string(), and memcmp().



Referenced by fdt\-\_\-get\-\_\-property\-\_\-namelen\-\_\-().


\begin{DoxyCode}
107 \{
108     \textcolor{keywordtype}{int} slen;
109     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *p = \hyperlink{fdt__ro_8c_a394c6c241f569f12b5b1f350dfb745ea}{fdt\_get\_string}(fdt, stroffset, &slen);
110 
111     \textcolor{keywordflow}{return} p && (slen == len) && (\hyperlink{cstd_8c_ace6c4869ab3af01c6f27eac47773917a}{memcmp}(p, s, len) == 0);
112 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a2492648af0491398295fac892cb8b758}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-stringlist\-\_\-contains@{fdt\-\_\-stringlist\-\_\-contains}}
\index{fdt\-\_\-stringlist\-\_\-contains@{fdt\-\_\-stringlist\-\_\-contains}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-stringlist\-\_\-contains}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-stringlist\-\_\-contains (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{strlist, }
\item[{int}]{listlen, }
\item[{const char $\ast$}]{str}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a2492648af0491398295fac892cb8b758}
fdt\-\_\-stringlist\-\_\-contains -\/ check a string list property for a string \-: Property containing a list of strings to check \-: Length of property \-: String to search for

This is a utility function provided for convenience. The list contains one or more strings, each terminated by \textbackslash{}0, as is found in a device tree \char`\"{}compatible\char`\"{} property.

Return\-: 1 if the string is found in the list, 0 not found, or invalid list 

References fdt\-\_\-property\-::len, memchr(), memcmp(), and strlen().



Referenced by fdt\-\_\-node\-\_\-check\-\_\-compatible().


\begin{DoxyCode}
724 \{
725     \textcolor{keywordtype}{int} len = \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(str);
726     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *p;
727 
728     \textcolor{keywordflow}{while} (listlen >= len) \{
729         \textcolor{keywordflow}{if} (\hyperlink{cstd_8c_ace6c4869ab3af01c6f27eac47773917a}{memcmp}(str, strlist, len+1) == 0)
730             \textcolor{keywordflow}{return} 1;
731         p = \hyperlink{cstd_8c_a7a1a96cef371f847b925fb1478e04080}{memchr}(strlist, \textcolor{charliteral}{'\(\backslash\)0'}, listlen);
732         \textcolor{keywordflow}{if} (!p)
733             \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* malformed strlist.. */}
734         listlen -= (p-strlist) + 1;
735         strlist = p + 1;
736     \}
737     \textcolor{keywordflow}{return} 0;
738 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a9d33c2ffed049f4f1c60ffef7b66fba4}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-stringlist\-\_\-count@{fdt\-\_\-stringlist\-\_\-count}}
\index{fdt\-\_\-stringlist\-\_\-count@{fdt\-\_\-stringlist\-\_\-count}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-stringlist\-\_\-count}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-stringlist\-\_\-count (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{property}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a9d33c2ffed049f4f1c60ffef7b66fba4}


References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-A\-L\-U\-E, fdt\-\_\-getprop(), and strnlen().


\begin{DoxyCode}
741 \{
742     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *list, *end;
743     \textcolor{keywordtype}{int} length, count = 0;
744 
745     list = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, property, &length);
746     \textcolor{keywordflow}{if} (!list)
747         \textcolor{keywordflow}{return} length;
748 
749     end = list + length;
750 
751     \textcolor{keywordflow}{while} (list < end) \{
752         length = \hyperlink{cstd_8c_a7bd978e4981a80586c5b3a0dac22f0f2}{strnlen}(list, end - list) + 1;
753 
754         \textcolor{comment}{/* Abort if the last string isn't properly NUL-terminated. */}
755         \textcolor{keywordflow}{if} (list + length > end)
756             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a69e818556330b83a02de930b95216aa9}{FDT\_ERR\_BADVALUE};
757 
758         list += length;
759         count++;
760     \}
761 
762     \textcolor{keywordflow}{return} count;
763 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_aff9e731b810e8052140509d0c4ee19b5}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-stringlist\-\_\-get@{fdt\-\_\-stringlist\-\_\-get}}
\index{fdt\-\_\-stringlist\-\_\-get@{fdt\-\_\-stringlist\-\_\-get}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-stringlist\-\_\-get}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ fdt\-\_\-stringlist\-\_\-get (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{property, }
\item[{int}]{idx, }
\item[{int $\ast$}]{lenp}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_aff9e731b810e8052140509d0c4ee19b5}


References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-A\-L\-U\-E, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-getprop(), N\-U\-L\-L, and strnlen().


\begin{DoxyCode}
798 \{
799     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *list, *end;
800     \textcolor{keywordtype}{int} length;
801 
802     list = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, property, &length);
803     \textcolor{keywordflow}{if} (!list) \{
804         \textcolor{keywordflow}{if} (lenp)
805             *lenp = length;
806 
807         \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
808     \}
809 
810     end = list + length;
811 
812     \textcolor{keywordflow}{while} (list < end) \{
813         length = \hyperlink{cstd_8c_a7bd978e4981a80586c5b3a0dac22f0f2}{strnlen}(list, end - list) + 1;
814 
815         \textcolor{comment}{/* Abort if the last string isn't properly NUL-terminated. */}
816         \textcolor{keywordflow}{if} (list + length > end) \{
817             \textcolor{keywordflow}{if} (lenp)
818                 *lenp = -\hyperlink{libfdt_8h_a69e818556330b83a02de930b95216aa9}{FDT\_ERR\_BADVALUE};
819 
820             \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
821         \}
822 
823         \textcolor{keywordflow}{if} (idx == 0) \{
824             \textcolor{keywordflow}{if} (lenp)
825                 *lenp = length - 1;
826 
827             \textcolor{keywordflow}{return} list;
828         \}
829 
830         list += length;
831         idx--;
832     \}
833 
834     \textcolor{keywordflow}{if} (lenp)
835         *lenp = -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND};
836 
837     \textcolor{keywordflow}{return} \hyperlink{kfs_8c_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
838 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a13feaf7df3d4cc7d7927d78af31dba3e}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-stringlist\-\_\-search@{fdt\-\_\-stringlist\-\_\-search}}
\index{fdt\-\_\-stringlist\-\_\-search@{fdt\-\_\-stringlist\-\_\-search}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-stringlist\-\_\-search}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-stringlist\-\_\-search (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{const char $\ast$}]{property, }
\item[{const char $\ast$}]{string}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a13feaf7df3d4cc7d7927d78af31dba3e}


References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-A\-L\-U\-E, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-getprop(), fdt\-\_\-property\-::len, memcmp(), strlen(), and strnlen().


\begin{DoxyCode}
767 \{
768     \textcolor{keywordtype}{int} length, len, idx = 0;
769     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *list, *end;
770 
771     list = \hyperlink{fdt__ro_8c_a0a72997fe1eb5a57885bbb988256d08f}{fdt\_getprop}(fdt, nodeoffset, property, &length);
772     \textcolor{keywordflow}{if} (!list)
773         \textcolor{keywordflow}{return} length;
774 
775     len = \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(\textcolor{keywordtype}{string}) + 1;
776     end = list + length;
777 
778     \textcolor{keywordflow}{while} (list < end) \{
779         length = \hyperlink{cstd_8c_a7bd978e4981a80586c5b3a0dac22f0f2}{strnlen}(list, end - list) + 1;
780 
781         \textcolor{comment}{/* Abort if the last string isn't properly NUL-terminated. */}
782         \textcolor{keywordflow}{if} (list + length > end)
783             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a69e818556330b83a02de930b95216aa9}{FDT\_ERR\_BADVALUE};
784 
785         \textcolor{keywordflow}{if} (length == len && \hyperlink{cstd_8c_ace6c4869ab3af01c6f27eac47773917a}{memcmp}(list, \textcolor{keywordtype}{string}, length) == 0)
786             \textcolor{keywordflow}{return} idx;
787 
788         list += length;
789         idx++;
790     \}
791 
792     \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND};
793 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a22dd90f8bea25063fe0debae7683eb02}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-subnode\-\_\-offset@{fdt\-\_\-subnode\-\_\-offset}}
\index{fdt\-\_\-subnode\-\_\-offset@{fdt\-\_\-subnode\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-subnode\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-subnode\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{parentoffset, }
\item[{const char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a22dd90f8bea25063fe0debae7683eb02}


References fdt\-\_\-subnode\-\_\-offset\-\_\-namelen(), and strlen().



Referenced by overlay\-\_\-apply\-\_\-node(), overlay\-\_\-merge(), overlay\-\_\-symbol\-\_\-update(), and overlay\-\_\-update\-\_\-local\-\_\-node\-\_\-references().


\begin{DoxyCode}
246 \{
247     \textcolor{keywordflow}{return} \hyperlink{fdt__ro_8c_a515ddadab660b50e9d31c05c74f7d351}{fdt\_subnode\_offset\_namelen}(fdt, parentoffset, name, 
      \hyperlink{cstd_8c_a54684bded3e61e2d78d490650f9b706a}{strlen}(name));
248 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a515ddadab660b50e9d31c05c74f7d351}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-subnode\-\_\-offset\-\_\-namelen@{fdt\-\_\-subnode\-\_\-offset\-\_\-namelen}}
\index{fdt\-\_\-subnode\-\_\-offset\-\_\-namelen@{fdt\-\_\-subnode\-\_\-offset\-\_\-namelen}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-subnode\-\_\-offset\-\_\-namelen}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-subnode\-\_\-offset\-\_\-namelen (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset, }
\item[{const char $\ast$}]{name, }
\item[{int}]{namelen}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a515ddadab660b50e9d31c05c74f7d351}


References F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-next\-\_\-node(), fdt\-\_\-nodename\-\_\-eq\-\_\-(), and F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E.



Referenced by fdt\-\_\-add\-\_\-subnode\-\_\-namelen(), fdt\-\_\-path\-\_\-offset\-\_\-namelen(), fdt\-\_\-subnode\-\_\-offset(), and overlay\-\_\-symbol\-\_\-update().


\begin{DoxyCode}
227 \{
228     \textcolor{keywordtype}{int} depth;
229 
230     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
231 
232     \textcolor{keywordflow}{for} (depth = 0;
233          (offset >= 0) && (depth >= 0);
234          offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, &depth))
235         \textcolor{keywordflow}{if} ((depth == 1)
236             && \hyperlink{fdt__ro_8c_a2d417f67da75b1ebf2871428d952cf8f}{fdt\_nodename\_eq\_}(fdt, offset, name, namelen))
237             \textcolor{keywordflow}{return} offset;
238 
239     \textcolor{keywordflow}{if} (depth < 0)
240         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND};
241     \textcolor{keywordflow}{return} offset; \textcolor{comment}{/* error */}
242 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a6c960d975c6644172ccc71fc2c48dbb4}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset@{fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset}}
\index{fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset@{fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}int fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{nodeoffset, }
\item[{int}]{supernodedepth, }
\item[{int $\ast$}]{nodedepth}
\end{DoxyParamCaption}
)}}\label{fdt__ro_8c_a6c960d975c6644172ccc71fc2c48dbb4}
fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset -\/ find a specific ancestor of a node \-: pointer to the device tree blob \-: offset of the node whose parent to find \-: depth of the ancestor to find \-: pointer to an integer variable (will be overwritten) or N\-U\-L\-L

\hyperlink{fdt__ro_8c_a6c960d975c6644172ccc71fc2c48dbb4}{fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset()} finds an ancestor of the given node at a specific depth from the root (where the root itself has depth 0, its immediate subnodes depth 1 and so forth). So fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset(fdt, nodeoffset, 0, N\-U\-L\-L); will always return 0, the offset of the root node. If the node at nodeoffset has depth D, then\-: fdt\-\_\-supernode\-\_\-atdepth\-\_\-offset(fdt, nodeoffset, D, N\-U\-L\-L); will return nodeoffset itself.

N\-O\-T\-E\-: This function is expensive, as it must scan the device tree structure from the start to nodeoffset.

returns\-: structure block offset of the node at node offset's ancestor of depth supernodedepth ($>$=0), on success -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, nodeoffset does not refer to a B\-E\-G\-I\-N\-\_\-\-N\-O\-D\-E tag -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, supernodedepth was greater than the depth of nodeoffset -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-M\-A\-G\-I\-C, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-V\-E\-R\-S\-I\-O\-N, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-A\-T\-E, -\/\-F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, standard meanings 

References can\-\_\-assume, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-O\-F\-F\-S\-E\-T, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-I\-N\-T\-E\-R\-N\-A\-L, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-next\-\_\-node(), and F\-D\-T\-\_\-\-R\-O\-\_\-\-P\-R\-O\-B\-E.



Referenced by fdt\-\_\-node\-\_\-depth(), and fdt\-\_\-parent\-\_\-offset().


\begin{DoxyCode}
613 \{
614     \textcolor{keywordtype}{int} offset, depth;
615     \textcolor{keywordtype}{int} supernodeoffset = -\hyperlink{libfdt_8h_a02625761a47e8012c53fb389dd25fadd}{FDT\_ERR\_INTERNAL};
616 
617     \hyperlink{libfdt__internal_8h_ad6927f926180469d5c044ec5d3b2f84b}{FDT\_RO\_PROBE}(fdt);
618 
619     \textcolor{keywordflow}{if} (supernodedepth < 0)
620         \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND};
621 
622     \textcolor{keywordflow}{for} (offset = 0, depth = 0;
623          (offset >= 0) && (offset <= nodeoffset);
624          offset = \hyperlink{fdt_8c_a6603ac8041afcc7fde5c0b25de765103}{fdt\_next\_node}(fdt, offset, &depth)) \{
625         \textcolor{keywordflow}{if} (depth == supernodedepth)
626             supernodeoffset = offset;
627 
628         \textcolor{keywordflow}{if} (offset == nodeoffset) \{
629             \textcolor{keywordflow}{if} (nodedepth)
630                 *nodedepth = depth;
631 
632             \textcolor{keywordflow}{if} (supernodedepth > depth)
633                 \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND};
634             \textcolor{keywordflow}{else}
635                 \textcolor{keywordflow}{return} supernodeoffset;
636         \}
637     \}
638 
639     \textcolor{keywordflow}{if} (!\hyperlink{libfdt__internal_8h_ae26d08ffdd441f73ecf7de7ca35176b9}{can\_assume}(VALID\_INPUT)) \{
640         \textcolor{keywordflow}{if} ((offset == -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND}) || (offset >= 0))
641             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a5025b6b09a009bd2b516e6a831d7ce72}{FDT\_ERR\_BADOFFSET};
642         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (offset == -\hyperlink{libfdt_8h_a5025b6b09a009bd2b516e6a831d7ce72}{FDT\_ERR\_BADOFFSET})
643             \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_aef7e5f2183c72ef2b4698bb918d8f2f7}{FDT\_ERR\_BADSTRUCTURE};
644     \}
645 
646     \textcolor{keywordflow}{return} offset; \textcolor{comment}{/* error from fdt\_next\_node() */}
647 \}
\end{DoxyCode}
\hypertarget{fdt__ro_8c_a0a233378abbb816de0249098cb2fc450}{\index{fdt\-\_\-ro.\-c@{fdt\-\_\-ro.\-c}!nextprop\-\_\-@{nextprop\-\_\-}}
\index{nextprop\-\_\-@{nextprop\-\_\-}!fdt_ro.c@{fdt\-\_\-ro.\-c}}
\subsubsection[{nextprop\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}static int nextprop\-\_\- (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{fdt, }
\item[{int}]{offset}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fdt__ro_8c_a0a233378abbb816de0249098cb2fc450}


References F\-D\-T\-\_\-\-E\-N\-D, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-B\-A\-D\-S\-T\-R\-U\-C\-T\-U\-R\-E, F\-D\-T\-\_\-\-E\-R\-R\-\_\-\-N\-O\-T\-F\-O\-U\-N\-D, fdt\-\_\-next\-\_\-tag(), F\-D\-T\-\_\-\-N\-O\-P, and F\-D\-T\-\_\-\-P\-R\-O\-P.



Referenced by fdt\-\_\-first\-\_\-property\-\_\-offset(), and fdt\-\_\-next\-\_\-property\-\_\-offset().


\begin{DoxyCode}
202 \{
203     \hyperlink{libfdt__env_8h_a435d1572bf3f880d55459d9805097f62}{uint32\_t} tag;
204     \textcolor{keywordtype}{int} nextoffset;
205 
206     \textcolor{keywordflow}{do} \{
207         tag = \hyperlink{fdt_8c_ae1b4b34a1b1fa1230d3ccacf14446b61}{fdt\_next\_tag}(fdt, offset, &nextoffset);
208 
209         \textcolor{keywordflow}{switch} (tag) \{
210         \textcolor{keywordflow}{case} \hyperlink{fdt_8h_a53275b16340fb458df4782462f283d8c}{FDT\_END}:
211             \textcolor{keywordflow}{if} (nextoffset >= 0)
212                 \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_aef7e5f2183c72ef2b4698bb918d8f2f7}{FDT\_ERR\_BADSTRUCTURE};
213             \textcolor{keywordflow}{else}
214                 \textcolor{keywordflow}{return} nextoffset;
215 
216         \textcolor{keywordflow}{case} \hyperlink{fdt_8h_a3304a9313cbf7ecced77f89ff5f25dde}{FDT\_PROP}:
217             \textcolor{keywordflow}{return} offset;
218         \}
219         offset = nextoffset;
220     \} \textcolor{keywordflow}{while} (tag == \hyperlink{fdt_8h_a95f6ec2ae047c13339f80ca6adeafc21}{FDT\_NOP});
221 
222     \textcolor{keywordflow}{return} -\hyperlink{libfdt_8h_a93cfa052f4b28df4bfc7d336b692fa07}{FDT\_ERR\_NOTFOUND};
223 \}
\end{DoxyCode}
